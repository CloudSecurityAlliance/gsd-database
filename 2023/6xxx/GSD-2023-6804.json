{
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2023-6804"
      ],
      "details": "Improper privilege management allowed arbitrary workflows to be committed and run using an improperly scoped PAT. To exploit this, a workflow must have already existed in the target repo. This vulnerability affected all versions of GitHub Enterprise Server since 3.8 and was fixed in version 3.8.12, 3.9.7, 3.10.4, and 3.11.1. \n",
      "id": "GSD-2023-6804",
      "modified": "2023-12-14T06:01:34.831335Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "product-cna@github.com",
        "ID": "CVE-2023-6804",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "Enterprise Server",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "not down converted",
                          "x_cve_json_5_version_data": {
                            "defaultStatus": "affected",
                            "versions": [
                              {
                                "changes": [
                                  {
                                    "at": "3.8.12",
                                    "status": "unaffected"
                                  }
                                ],
                                "lessThanOrEqual": "3.8.11",
                                "status": "affected",
                                "version": "3.8.0",
                                "versionType": "semver"
                              },
                              {
                                "changes": [
                                  {
                                    "at": "3.9.7",
                                    "status": "unaffected"
                                  }
                                ],
                                "lessThanOrEqual": "3.9.6",
                                "status": "affected",
                                "version": "3.9.0",
                                "versionType": "semver"
                              },
                              {
                                "changes": [
                                  {
                                    "at": "3.10.4",
                                    "status": "unaffected"
                                  }
                                ],
                                "lessThanOrEqual": "3.10.3",
                                "status": "affected",
                                "version": "3.10.0",
                                "versionType": "semver"
                              },
                              {
                                "changes": [
                                  {
                                    "at": "3.11.1",
                                    "status": "unaffected"
                                  }
                                ],
                                "lessThanOrEqual": "3.11.0",
                                "status": "affected",
                                "version": "3.11",
                                "versionType": "semver"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "GitHub"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "Improper privilege management allowed arbitrary workflows to be committed and run using an improperly scoped PAT. To exploit this, a workflow must have already existed in the target repo. This vulnerability affected all versions of GitHub Enterprise Server since 3.8 and was fixed in version 3.8.12, 3.9.7, 3.10.4, and 3.11.1. \n"
          }
        ]
      },
      "generator": {
        "engine": "Vulnogram 0.1.0-dev"
      },
      "impact": {
        "cvss": [
          {
            "attackComplexity": "HIGH",
            "attackVector": "LOCAL",
            "availabilityImpact": "LOW",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "LOW",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L",
            "version": "3.1"
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "cweId": "CWE-269",
                "lang": "eng",
                "value": "CWE-269 Improper Privilege Management"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.12",
            "refsource": "MISC",
            "url": "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.12"
          },
          {
            "name": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.7",
            "refsource": "MISC",
            "url": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.7"
          },
          {
            "name": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.4",
            "refsource": "MISC",
            "url": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.4"
          },
          {
            "name": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.1",
            "refsource": "MISC",
            "url": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.1"
          }
        ]
      },
      "source": {
        "discovery": "UNKNOWN"
      }
    },
    "nvd.nist.gov": {
      "cve": {
        "configurations": [
          {
            "nodes": [
              {
                "cpeMatch": [
                  {
                    "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*",
                    "matchCriteriaId": "B3D983FF-FDDE-484C-AA34-31EB52E25EC2",
                    "versionEndExcluding": "3.8.12",
                    "versionStartIncluding": "3.8.0",
                    "vulnerable": true
                  },
                  {
                    "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*",
                    "matchCriteriaId": "B118EB53-4459-4817-8F74-002DBA4860DA",
                    "versionEndExcluding": "3.9.7",
                    "versionStartIncluding": "3.9.0",
                    "vulnerable": true
                  },
                  {
                    "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*",
                    "matchCriteriaId": "F65FB74F-11AB-439B-9CF0-9F08E03E4083",
                    "versionEndExcluding": "3.10.4",
                    "versionStartIncluding": "3.10.0",
                    "vulnerable": true
                  },
                  {
                    "criteria": "cpe:2.3:a:github:enterprise_server:3.11.0:*:*:*:*:*:*:*",
                    "matchCriteriaId": "AC723276-C3EE-4F79-857A-3A5C078C33E2",
                    "vulnerable": true
                  }
                ],
                "negate": false,
                "operator": "OR"
              }
            ]
          }
        ],
        "descriptions": [
          {
            "lang": "en",
            "value": "Improper privilege management allowed arbitrary workflows to be committed and run using an improperly scoped PAT. To exploit this, a workflow must have already existed in the target repo. This vulnerability affected all versions of GitHub Enterprise Server since 3.8 and was fixed in version 3.8.12, 3.9.7, 3.10.4, and 3.11.1. \n"
          },
          {
            "lang": "es",
            "value": "La gesti\u00f3n inadecuada de privilegios permiti\u00f3 que se confirmaran y ejecutaran workflows arbitrarios utilizando una PAT con un alcance inadecuado. Para aprovechar esto, ya debe haber existido un flujo de trabajo en el repositorio de destino. Esta vulnerabilidad afect\u00f3 a todas las versiones de GitHub Enterprise Server desde la 3.8 y se solucion\u00f3 en las versiones 3.8.12, 3.9.7, 3.10.4 y 3.11.1."
          }
        ],
        "id": "CVE-2023-6804",
        "lastModified": "2023-12-29T19:15:50.637",
        "metrics": {
          "cvssMetricV31": [
            {
              "cvssData": {
                "attackComplexity": "LOW",
                "attackVector": "LOCAL",
                "availabilityImpact": "NONE",
                "baseScore": 5.5,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "HIGH",
                "privilegesRequired": "LOW",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
                "version": "3.1"
              },
              "exploitabilityScore": 1.8,
              "impactScore": 3.6,
              "source": "nvd@nist.gov",
              "type": "Primary"
            },
            {
              "cvssData": {
                "attackComplexity": "HIGH",
                "attackVector": "LOCAL",
                "availabilityImpact": "LOW",
                "baseScore": 6.5,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "LOW",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L",
                "version": "3.1"
              },
              "exploitabilityScore": 1.0,
              "impactScore": 5.5,
              "source": "product-cna@github.com",
              "type": "Secondary"
            }
          ]
        },
        "published": "2023-12-21T21:15:15.020",
        "references": [
          {
            "source": "product-cna@github.com",
            "tags": [
              "Release Notes"
            ],
            "url": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.4"
          },
          {
            "source": "product-cna@github.com",
            "tags": [
              "Release Notes"
            ],
            "url": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.1"
          },
          {
            "source": "product-cna@github.com",
            "tags": [
              "Release Notes"
            ],
            "url": "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.12"
          },
          {
            "source": "product-cna@github.com",
            "tags": [
              "Release Notes"
            ],
            "url": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.7"
          }
        ],
        "sourceIdentifier": "product-cna@github.com",
        "vulnStatus": "Analyzed",
        "weaknesses": [
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-269"
              }
            ],
            "source": "nvd@nist.gov",
            "type": "Primary"
          },
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-269"
              }
            ],
            "source": "product-cna@github.com",
            "type": "Secondary"
          }
        ]
      }
    }
  }
}