{
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2023-6837"
      ],
      "details": "Multiple WSO2 products have been identified as vulnerable to perform user impersonatoin using JIT provisioning.\u00a0In order for this vulnerability to have any impact on your deployment, following conditions must be met:\n\n  *  An IDP configured for federated authentication and JIT provisioning enabled with the \"Prompt for username, password and consent\" option.\n  *  A service provider that uses the above IDP for federated authentication and has the \"Assert identity using mapped local subject identifier\" flag enabled.\n\n\nAttacker should have:\n\n  *  A fresh valid user account in the federated IDP that has not been used earlier.\n  *  Knowledge of the username of a valid user in the local IDP.\n\n\nWhen all preconditions are met, a malicious actor could use JIT provisioning flow to perform user impersonation.\n\n",
      "id": "GSD-2023-6837",
      "modified": "2023-12-16T06:01:29.569696Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "security@wso2.com",
        "ID": "CVE-2023-6837",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "WSO2 API Manager",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "not down converted",
                          "x_cve_json_5_version_data": {
                            "defaultStatus": "unaffected",
                            "versions": [
                              {
                                "lessThan": "2.5.0.0",
                                "status": "unknown",
                                "version": "0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "2.5.0.32",
                                "status": "affected",
                                "version": "2.5.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "2.6.0.52",
                                "status": "affected",
                                "version": "2.6.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "3.0.0.50",
                                "status": "affected",
                                "version": "3.0.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "3.1.0.72",
                                "status": "affected",
                                "version": "3.1.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "3.2.0.86",
                                "status": "affected",
                                "version": "3.2.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "4.0.0.35",
                                "status": "affected",
                                "version": "4.0.0.0",
                                "versionType": "custom"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "WSO2 Identity Server",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "not down converted",
                          "x_cve_json_5_version_data": {
                            "defaultStatus": "unaffected",
                            "versions": [
                              {
                                "lessThan": "5.6.0.0",
                                "status": "unknown",
                                "version": "0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.6.0.16",
                                "status": "affected",
                                "version": "5.6.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.7.0.35",
                                "status": "affected",
                                "version": "5.7.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.8.0.26",
                                "status": "affected",
                                "version": "5.8.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.9.0.38",
                                "status": "affected",
                                "version": "5.9.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.10.0.78",
                                "status": "affected",
                                "version": "5.10.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.11.0.69",
                                "status": "affected",
                                "version": "5.11.0.0",
                                "versionType": "custom"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "WSO2 IS as Key Manager",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "not down converted",
                          "x_cve_json_5_version_data": {
                            "defaultStatus": "unaffected",
                            "versions": [
                              {
                                "lessThan": "5.6.0.0",
                                "status": "unknown",
                                "version": "0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.6.0.17",
                                "status": "affected",
                                "version": "5.6.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.7.0.39",
                                "status": "affected",
                                "version": "5.7.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.9.0.45",
                                "status": "affected",
                                "version": "5.9.0.0",
                                "versionType": "custom"
                              },
                              {
                                "lessThan": "5.10.0.80",
                                "status": "affected",
                                "version": "5.10.0.0",
                                "versionType": "custom"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "WSO2"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "Multiple WSO2 products have been identified as vulnerable to perform user impersonatoin using JIT provisioning.\u00a0In order for this vulnerability to have any impact on your deployment, following conditions must be met:\n\n  *  An IDP configured for federated authentication and JIT provisioning enabled with the \"Prompt for username, password and consent\" option.\n  *  A service provider that uses the above IDP for federated authentication and has the \"Assert identity using mapped local subject identifier\" flag enabled.\n\n\nAttacker should have:\n\n  *  A fresh valid user account in the federated IDP that has not been used earlier.\n  *  Knowledge of the username of a valid user in the local IDP.\n\n\nWhen all preconditions are met, a malicious actor could use JIT provisioning flow to perform user impersonation.\n\n"
          }
        ]
      },
      "generator": {
        "engine": "Vulnogram 0.1.0-dev"
      },
      "impact": {
        "cvss": [
          {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 8.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "LOW",
            "privilegesRequired": "LOW",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N",
            "version": "3.1"
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "lang": "eng",
                "value": "n/a"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/",
            "refsource": "MISC",
            "url": "https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/"
          }
        ]
      },
      "solution": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "For WSO2 Subscription holders, the recommended solution is to apply the provided patch/update to the affected versions of the products. If there are any instructions given with the patch/update, please make sure those are followed properly.<br><br>Community users may apply the relevant fixes to the product based on the public fix(s) advertised in&nbsp;<a target=\"_blank\" rel=\"nofollow\" href=\"https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/\">https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1...</a><br>"
            }
          ],
          "value": "For WSO2 Subscription holders, the recommended solution is to apply the provided patch/update to the affected versions of the products. If there are any instructions given with the patch/update, please make sure those are followed properly.\n\nCommunity users may apply the relevant fixes to the product based on the public fix(s) advertised in\u00a0 https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1... https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/ \n"
        }
      ],
      "source": {
        "discovery": "UNKNOWN"
      }
    },
    "nvd.nist.gov": {
      "cve": {
        "descriptions": [
          {
            "lang": "en",
            "value": "Multiple WSO2 products have been identified as vulnerable to perform user impersonatoin using JIT provisioning.\u00a0In order for this vulnerability to have any impact on your deployment, following conditions must be met:\n\n  *  An IDP configured for federated authentication and JIT provisioning enabled with the \"Prompt for username, password and consent\" option.\n  *  A service provider that uses the above IDP for federated authentication and has the \"Assert identity using mapped local subject identifier\" flag enabled.\n\n\nAttacker should have:\n\n  *  A fresh valid user account in the federated IDP that has not been used earlier.\n  *  Knowledge of the username of a valid user in the local IDP.\n\n\nWhen all preconditions are met, a malicious actor could use JIT provisioning flow to perform user impersonation.\n\n"
          },
          {
            "lang": "es",
            "value": "Se han identificado varios productos WSO2 como vulnerables para realizar suplantaciones de usuarios mediante el aprovisionamiento JIT. Para que esta vulnerabilidad tenga alg\u00fan impacto en su implementaci\u00f3n, se deben cumplir las siguientes condiciones: * Un IDP configurado para autenticaci\u00f3n federada y aprovisionamiento JIT habilitado con la opci\u00f3n \"Solicitar nombre de usuario, contrase\u00f1a y consentimiento\". * Un proveedor de servicios que utiliza el IDP anterior para la autenticaci\u00f3n federada y tiene habilitada la opci\u00f3n \"Afirmar identidad utilizando un identificador de sujeto local asignado\". El atacante debe tener: * Una cuenta de usuario nueva y v\u00e1lida en el IDP federado que no se haya utilizado anteriormente. * Conocimiento del nombre de usuario de un usuario v\u00e1lido en el IDP local. Cuando se cumplen todas las condiciones previas, un actor malintencionado podr\u00eda utilizar el flujo de aprovisionamiento JIT para realizar la suplantaci\u00f3n de usuario."
          }
        ],
        "id": "CVE-2023-6837",
        "lastModified": "2023-12-15T13:41:51.403",
        "metrics": {
          "cvssMetricV31": [
            {
              "cvssData": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 8.5,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "LOW",
                "privilegesRequired": "LOW",
                "scope": "CHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N",
                "version": "3.1"
              },
              "exploitabilityScore": 3.1,
              "impactScore": 4.7,
              "source": "ed10eef1-636d-4fbe-9993-6890dfa878f8",
              "type": "Secondary"
            }
          ]
        },
        "published": "2023-12-15T10:15:09.767",
        "references": [
          {
            "source": "ed10eef1-636d-4fbe-9993-6890dfa878f8",
            "url": "https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/"
          }
        ],
        "sourceIdentifier": "ed10eef1-636d-4fbe-9993-6890dfa878f8",
        "vulnStatus": "Awaiting Analysis"
      }
    }
  }
}