{
  "GSD": {
    "alias": "CVE-2023-33246",
    "id": "GSD-2023-33246"
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2023-33246"
      ],
      "details": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n",
      "id": "GSD-2023-33246",
      "modified": "2023-12-13T01:20:36.934001Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "security@apache.org",
        "ID": "CVE-2023-33246",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "Apache RocketMQ",
                    "version": {
                      "version_data": [
                        {
                          "version_affected": "<=",
                          "version_name": "0",
                          "version_value": "5.1.0"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "Apache Software Foundation"
            }
          ]
        }
      },
      "credits": [
        {
          "lang": "en",
          "value": "lvyyevd@gmail.com"
        }
      ],
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n"
          }
        ]
      },
      "generator": {
        "engine": "Vulnogram 0.1.0-dev"
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "cweId": "CWE-94",
                "lang": "eng",
                "value": "CWE-94 Improper Control of Generation of Code ('Code Injection')"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp",
            "refsource": "MISC",
            "url": "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp"
          },
          {
            "name": "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html",
            "refsource": "MISC",
            "url": "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html"
          },
          {
            "name": "http://www.openwall.com/lists/oss-security/2023/07/12/1",
            "refsource": "MISC",
            "url": "http://www.openwall.com/lists/oss-security/2023/07/12/1"
          }
        ]
      },
      "source": {
        "discovery": "EXTERNAL"
      }
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": "(,5.1.1)",
          "affected_versions": "All versions before 5.1.1",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-937",
            "CWE-94"
          ],
          "date": "2023-07-12",
          "description": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n",
          "fixed_versions": [
            "5.1.1"
          ],
          "identifier": "CVE-2023-33246",
          "identifiers": [
            "CVE-2023-33246"
          ],
          "not_impacted": "All versions starting from 5.1.1",
          "package_slug": "maven/org.apache.rocketmq/rocketmq-broker",
          "pubdate": "2023-05-24",
          "solution": "Upgrade to version 5.1.1 or above.",
          "title": "Improper Control of Generation of Code ('Code Injection')",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2023-33246",
            "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp"
          ],
          "uuid": "7c1f8bbb-a4f5-49de-b083-bb17eb8254ba"
        },
        {
          "affected_range": "(,5.1.1)",
          "affected_versions": "All versions before 5.1.1",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-937",
            "CWE-94"
          ],
          "date": "2023-07-12",
          "description": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n",
          "fixed_versions": [
            "5.1.1"
          ],
          "identifier": "CVE-2023-33246",
          "identifiers": [
            "CVE-2023-33246"
          ],
          "not_impacted": "All versions starting from 5.1.1",
          "package_slug": "maven/org.apache.rocketmq/rocketmq-client",
          "pubdate": "2023-05-24",
          "solution": "Upgrade to version 5.1.1 or above.",
          "title": "Improper Control of Generation of Code ('Code Injection')",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2023-33246",
            "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp"
          ],
          "uuid": "549311fb-56ee-41bb-83b7-99fcf88a7b6b"
        },
        {
          "affected_range": "[5.0.0,5.1.1)",
          "affected_versions": "All versions starting from 5.0.0 before 5.1.1",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-78",
            "CWE-937",
            "CWE-94"
          ],
          "date": "2023-07-12",
          "description": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n",
          "fixed_versions": [
            "5.1.1"
          ],
          "identifier": "CVE-2023-33246",
          "identifiers": [
            "GHSA-x3cq-8f32-5f63",
            "CVE-2023-33246"
          ],
          "not_impacted": "All versions before 5.0.0, all versions starting from 5.1.1",
          "package_slug": "maven/org.apache.rocketmq/rocketmq-controller",
          "pubdate": "2023-07-06",
          "solution": "Upgrade to version 5.1.1 or above.",
          "title": "Improper Control of Generation of Code ('Code Injection')",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2023-33246",
            "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp",
            "https://github.com/apache/rocketmq/commit/9d411cf04a695e7a3f41036e8377b0aa544d754d",
            "https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703",
            "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html",
            "http://www.openwall.com/lists/oss-security/2023/07/12/1",
            "https://github.com/advisories/GHSA-x3cq-8f32-5f63"
          ],
          "uuid": "560441f6-1792-4013-a005-8ccdc5c269d8"
        },
        {
          "affected_range": "[4.0.0,4.9.6),[5.0.0,5.1.1)",
          "affected_versions": "All versions starting from 4.0.0 before 4.9.6, all versions starting from 5.0.0 before 5.1.1",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-78",
            "CWE-937",
            "CWE-94"
          ],
          "date": "2023-07-12",
          "description": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n",
          "fixed_versions": [
            "4.9.6",
            "5.1.1"
          ],
          "identifier": "CVE-2023-33246",
          "identifiers": [
            "GHSA-x3cq-8f32-5f63",
            "CVE-2023-33246"
          ],
          "not_impacted": "All versions before 4.0.0, all versions starting from 4.9.6 before 5.0.0, all versions starting from 5.1.1",
          "package_slug": "maven/org.apache.rocketmq/rocketmq-namesrv",
          "pubdate": "2023-07-06",
          "solution": "Upgrade to versions 4.9.6, 5.1.1 or above.",
          "title": "Improper Control of Generation of Code ('Code Injection')",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2023-33246",
            "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp",
            "https://github.com/apache/rocketmq/commit/9d411cf04a695e7a3f41036e8377b0aa544d754d",
            "https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703",
            "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html",
            "http://www.openwall.com/lists/oss-security/2023/07/12/1",
            "https://github.com/advisories/GHSA-x3cq-8f32-5f63"
          ],
          "uuid": "67931e40-c587-4f9b-9a17-9940ee99b558"
        }
      ]
    },
    "nvd.nist.gov": {
      "configurations": {
        "CVE_data_version": "4.0",
        "nodes": [
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:a:apache:rocketmq:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndExcluding": "5.1.1",
                "vulnerable": true
              }
            ],
            "operator": "OR"
          }
        ]
      },
      "cve": {
        "CVE_data_meta": {
          "ASSIGNER": "security@apache.org",
          "ID": "CVE-2023-33246"
        },
        "data_format": "MITRE",
        "data_type": "CVE",
        "data_version": "4.0",
        "description": {
          "description_data": [
            {
              "lang": "en",
              "value": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.\u00a0\n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.\u00a0\n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above\u00a0for using RocketMQ 5.x\u00a0or 4.9.6 or above for using RocketMQ 4.x .\n\n\n\n\n\n\n\n\n\n\n\n"
            }
          ]
        },
        "problemtype": {
          "problemtype_data": [
            {
              "description": [
                {
                  "lang": "en",
                  "value": "CWE-94"
                }
              ]
            }
          ]
        },
        "references": {
          "reference_data": [
            {
              "name": "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp",
              "refsource": "MISC",
              "tags": [
                "Mailing List",
                "Vendor Advisory"
              ],
              "url": "https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp"
            },
            {
              "name": "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html",
              "refsource": "MISC",
              "tags": [],
              "url": "http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html"
            },
            {
              "name": "http://www.openwall.com/lists/oss-security/2023/07/12/1",
              "refsource": "MISC",
              "tags": [],
              "url": "http://www.openwall.com/lists/oss-security/2023/07/12/1"
            }
          ]
        }
      },
      "impact": {
        "baseMetricV3": {
          "cvssV3": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      },
      "lastModifiedDate": "2023-07-12T12:15Z",
      "publishedDate": "2023-05-24T15:15Z"
    }
  }
}