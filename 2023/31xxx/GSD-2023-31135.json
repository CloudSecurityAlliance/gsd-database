{
  "GSD": {
    "alias": "CVE-2023-31135",
    "id": "GSD-2023-31135"
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2023-31135"
      ],
      "details": "Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a baseIv which is initialized when an audit log is created. The last 4 bytes come from the length of the log line being encrypted. This is problematic because two log lines will often have the same length, so due to these collisions we are reusing the same nonce many times. All audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should store existing audit logs in a secure location and for extra security, encrypt using an external tool like `gpg`.",
      "id": "GSD-2023-31135",
      "modified": "2023-12-13T01:20:29.710785Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "security-advisories@github.com",
        "ID": "CVE-2023-31135",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "dgraph",
                    "version": {
                      "version_data": [
                        {
                          "version_affected": "=",
                          "version_value": "< 23.0.0"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "dgraph-io"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a baseIv which is initialized when an audit log is created. The last 4 bytes come from the length of the log line being encrypted. This is problematic because two log lines will often have the same length, so due to these collisions we are reusing the same nonce many times. All audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should store existing audit logs in a secure location and for extra security, encrypt using an external tool like `gpg`."
          }
        ]
      },
      "impact": {
        "cvss": [
          {
            "attackComplexity": "LOW",
            "attackVector": "LOCAL",
            "availabilityImpact": "NONE",
            "baseScore": 3.3,
            "baseSeverity": "LOW",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "privilegesRequired": "LOW",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
            "version": "3.1"
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "cweId": "CWE-326",
                "lang": "eng",
                "value": "CWE-326: Inadequate Encryption Strength"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47",
            "refsource": "MISC",
            "url": "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47"
          },
          {
            "name": "https://github.com/dgraph-io/dgraph/pull/8323",
            "refsource": "MISC",
            "url": "https://github.com/dgraph-io/dgraph/pull/8323"
          },
          {
            "name": "https://en.wikipedia.org/wiki/Cryptographic_nonce",
            "refsource": "MISC",
            "url": "https://en.wikipedia.org/wiki/Cryptographic_nonce"
          }
        ]
      },
      "source": {
        "advisory": "GHSA-92wq-q9pq-gw47",
        "discovery": "UNKNOWN"
      }
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": "<v23.0.0",
          "affected_versions": "All versions before 23.0.0",
          "cvss_v3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "cwe_ids": [
            "CWE-1035",
            "CWE-326",
            "CWE-937"
          ],
          "date": "2023-05-25",
          "description": "Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs is vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a baseIv which is initialized when an audit log is created. The last 4 bytes come from the length of the log line being encrypted. This is problematic because two log lines will often have the same length, so due to these collisions we are reusing the same nonce many times. All audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should store existing audit logs in a secure location and for extra security, encrypt using an external tool like `gpg`.",
          "fixed_versions": [
            "v23.0.0"
          ],
          "identifier": "CVE-2023-31135",
          "identifiers": [
            "CVE-2023-31135",
            "GHSA-92wq-q9pq-gw47"
          ],
          "not_impacted": "All versions starting from 23.0.0",
          "package_slug": "go/github.com/dgraph-io/dgraph",
          "pubdate": "2023-05-17",
          "solution": "Upgrade to version 23.0.0 or above.",
          "title": "Inadequate Encryption Strength",
          "urls": [
            "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47",
            "https://github.com/dgraph-io/dgraph/pull/8323",
            "https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0",
            "https://nvd.nist.gov/vuln/detail/CVE-2023-31135",
            "https://en.wikipedia.org/wiki/Cryptographic_nonce",
            "https://github.com/advisories/GHSA-92wq-q9pq-gw47"
          ],
          "uuid": "3404153f-c94b-4455-b9e6-7b650f134d6b",
          "versions": [
            {
              "commit": {
                "sha": "38980bc4a44352094c15ddfe4b606a8f05b48e81",
                "tags": [
                  "v23.0.0"
                ],
                "timestamp": "20230508215612"
              },
              "number": "v23.0.0"
            }
          ]
        }
      ]
    },
    "nvd.nist.gov": {
      "configurations": {
        "CVE_data_version": "4.0",
        "nodes": [
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*",
                "cpe_name": [],
                "versionEndExcluding": "23.0.0",
                "vulnerable": true
              }
            ],
            "operator": "OR"
          }
        ]
      },
      "cve": {
        "CVE_data_meta": {
          "ASSIGNER": "security-advisories@github.com",
          "ID": "CVE-2023-31135"
        },
        "data_format": "MITRE",
        "data_type": "CVE",
        "data_version": "4.0",
        "description": {
          "description_data": [
            {
              "lang": "en",
              "value": "Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a baseIv which is initialized when an audit log is created. The last 4 bytes come from the length of the log line being encrypted. This is problematic because two log lines will often have the same length, so due to these collisions we are reusing the same nonce many times. All audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should store existing audit logs in a secure location and for extra security, encrypt using an external tool like `gpg`."
            }
          ]
        },
        "problemtype": {
          "problemtype_data": [
            {
              "description": [
                {
                  "lang": "en",
                  "value": "CWE-326"
                }
              ]
            }
          ]
        },
        "references": {
          "reference_data": [
            {
              "name": "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47",
              "refsource": "MISC",
              "tags": [
                "Vendor Advisory"
              ],
              "url": "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47"
            },
            {
              "name": "https://en.wikipedia.org/wiki/Cryptographic_nonce",
              "refsource": "MISC",
              "tags": [
                "Technical Description"
              ],
              "url": "https://en.wikipedia.org/wiki/Cryptographic_nonce"
            },
            {
              "name": "https://github.com/dgraph-io/dgraph/pull/8323",
              "refsource": "MISC",
              "tags": [
                "Issue Tracking",
                "Patch"
              ],
              "url": "https://github.com/dgraph-io/dgraph/pull/8323"
            }
          ]
        }
      },
      "impact": {
        "baseMetricV3": {
          "cvssV3": {
            "attackComplexity": "LOW",
            "attackVector": "LOCAL",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "privilegesRequired": "LOW",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "version": "3.1"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        }
      },
      "lastModifiedDate": "2023-05-25T17:01Z",
      "publishedDate": "2023-05-17T18:15Z"
    }
  }
}