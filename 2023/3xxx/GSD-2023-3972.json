{
    "GSD": {
        "alias": "CVE-2023-3972",
        "id": "GSD-2023-3972"
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "secalert@redhat.com",
                "ID": "CVE-2023-3972",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "insights-client",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "versions": [
                                                            {
                                                                "status": "unaffected",
                                                                "version": "3.2.2"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "n/a"
                        },
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Red Hat Enterprise Linux 8",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.2-1.el8_8",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.3-1.el8_2",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 8.2 Telecommunications Update Service",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.3-1.el8_2",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 8.2 Update Services for SAP Solutions",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.3-1.el8_2",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.2-1.el8_6",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 9",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected",
                                                        "versions": [
                                                            {
                                                                "lessThan": "*",
                                                                "status": "unaffected",
                                                                "version": "0:3.2.2-1.el9_2",
                                                                "versionType": "rpm"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 6",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "unknown"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "product_name": "Red Hat Enterprise Linux 7",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "not down converted",
                                                    "x_cve_json_5_version_data": {
                                                        "defaultStatus": "affected"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "Red Hat"
                        }
                    ]
                }
            },
            "credits": [
                {
                    "lang": "en",
                    "value": "This issue was discovered by Alasdair Kergon (Red Hat) and Pavel Odvody (Red Hat)."
                }
            ],
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "A vulnerability was found in insights-client. This security issue occurs because of insecure file operations or unsafe handling of temporary files and directories that lead to local privilege escalation. Before the insights-client has been registered on the system by root, an unprivileged local user or attacker could create the /var/tmp/insights-client directory (owning the directory with read, write, and execute permissions) on the system. After the insights-client is registered by root, an attacker could then control the directory content that insights are using by putting malicious scripts into it and executing arbitrary code as root (trivially bypassing SELinux protections because insights processes are allowed to disable SELinux system-wide)."
                    }
                ]
            },
            "impact": {
                "cvss": [
                    {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    }
                ]
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "cweId": "CWE-379",
                                "lang": "eng",
                                "value": "Creation of Temporary File in Directory with Insecure Permissions"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://access.redhat.com/errata/RHSA-2023:6264",
                        "refsource": "MISC",
                        "url": "https://access.redhat.com/errata/RHSA-2023:6264"
                    },
                    {
                        "name": "https://access.redhat.com/errata/RHSA-2023:6282",
                        "refsource": "MISC",
                        "url": "https://access.redhat.com/errata/RHSA-2023:6282"
                    },
                    {
                        "name": "https://access.redhat.com/errata/RHSA-2023:6283",
                        "refsource": "MISC",
                        "url": "https://access.redhat.com/errata/RHSA-2023:6283"
                    },
                    {
                        "name": "https://access.redhat.com/errata/RHSA-2023:6284",
                        "refsource": "MISC",
                        "url": "https://access.redhat.com/errata/RHSA-2023:6284"
                    },
                    {
                        "name": "https://access.redhat.com/security/cve/CVE-2023-3972",
                        "refsource": "MISC",
                        "url": "https://access.redhat.com/security/cve/CVE-2023-3972"
                    },
                    {
                        "name": "https://bugzilla.redhat.com/show_bug.cgi?id=2227027",
                        "refsource": "MISC",
                        "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2227027"
                    },
                    {
                        "name": "https://github.com/RedHatInsights/insights-core/pull/3878",
                        "refsource": "MISC",
                        "url": "https://github.com/RedHatInsights/insights-core/pull/3878"
                    }
                ]
            },
            "work_around": [
                {
                    "lang": "en",
                    "value": "Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affected package as soon as possible."
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": []
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "secalert@redhat.com",
                    "ID": "CVE-2023-3972"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "A vulnerability was found in insights-client. This security issue occurs because of insecure file operations or unsafe handling of temporary files and directories that lead to local privilege escalation. Before the insights-client has been registered on the system by root, an unprivileged local user or attacker could create the /var/tmp/insights-client directory (owning the directory with read, write, and execute permissions) on the system. After the insights-client is registered by root, an attacker could then control the directory content that insights are using by putting malicious scripts into it and executing arbitrary code as root (trivially bypassing SELinux protections because insights processes are allowed to disable SELinux system-wide)."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": []
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://bugzilla.redhat.com/show_bug.cgi?id=2227027",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2227027"
                        },
                        {
                            "name": "https://access.redhat.com/security/cve/CVE-2023-3972",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://access.redhat.com/security/cve/CVE-2023-3972"
                        },
                        {
                            "name": "https://github.com/RedHatInsights/insights-core/pull/3878",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://github.com/RedHatInsights/insights-core/pull/3878"
                        },
                        {
                            "name": "https://access.redhat.com/errata/RHSA-2023:6264",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://access.redhat.com/errata/RHSA-2023:6264"
                        },
                        {
                            "name": "https://access.redhat.com/errata/RHSA-2023:6282",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://access.redhat.com/errata/RHSA-2023:6282"
                        },
                        {
                            "name": "https://access.redhat.com/errata/RHSA-2023:6284",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://access.redhat.com/errata/RHSA-2023:6284"
                        },
                        {
                            "name": "https://access.redhat.com/errata/RHSA-2023:6283",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://access.redhat.com/errata/RHSA-2023:6283"
                        }
                    ]
                }
            },
            "impact": {},
            "lastModifiedDate": "2023-11-02T14:15Z",
            "publishedDate": "2023-11-01T16:15Z"
        }
    }
}