{
    "GSD": {
        "alias": "CVE-2019-5629",
        "description": "Rapid7 Insight Agent, version 2.6.3 and prior, suffers from a local privilege escalation due to an uncontrolled DLL search path. Specifically, when Insight Agent 2.6.3 and prior starts, the Python interpreter attempts to load python3.dll at \"C:\\DLLs\\python3.dll,\" which normally is writable by locally authenticated users. Because of this, a malicious local user could use Insight Agent's startup conditions to elevate to SYSTEM privileges. This issue was fixed in Rapid7 Insight Agent 2.6.4.",
        "id": "GSD-2019-5629",
        "references": [
            "https://packetstormsecurity.com/files/cve/CVE-2019-5629"
        ]
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "cve@rapid7.com",
                "DATE_PUBLIC": "2019-05-29T17:17:00.000Z",
                "ID": "CVE-2019-5629",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Insight Agent",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "2.6.3 and prior"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "Rapid7"
                        }
                    ]
                }
            },
            "credit": [
                {
                    "lang": "eng",
                    "value": "This issue was discovered, and reported to Rapid7, by independent researcher Florian Bogner at Bee IT Security. It is being disclosed in accordance with Rapid7's vulnerability disclosure policy (https://www.rapid7.com/disclosure/)."
                }
            ],
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Rapid7 Insight Agent, version 2.6.3 and prior, suffers from a local privilege escalation due to an uncontrolled DLL search path. Specifically, when Insight Agent 2.6.3 and prior starts, the Python interpreter attempts to load python3.dll at \"C:\\DLLs\\python3.dll,\" which normally is writable by locally authenticated users. Because of this, a malicious local user could use Insight Agent's startup conditions to elevate to SYSTEM privileges. This issue was fixed in Rapid7 Insight Agent 2.6.4."
                    }
                ]
            },
            "generator": {
                "engine": "Vulnogram 0.0.7"
            },
            "impact": {
                "cvss": {
                    "attackComplexity": "LOW",
                    "attackVector": "LOCAL",
                    "availabilityImpact": "HIGH",
                    "baseScore": 7.8,
                    "baseSeverity": "HIGH",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "privilegesRequired": "LOW",
                    "scope": "UNCHANGED",
                    "userInteraction": "NONE",
                    "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                    "version": "3.0"
                }
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "CWE-427: Uncontrolled Search Path Element"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "20190603 Rapid7's Windows InsightIDR Agent: Local Privilege Escalation",
                        "refsource": "BUGTRAQ",
                        "url": "https://seclists.org/bugtraq/2019/Jun/0"
                    },
                    {
                        "name": "http://packetstormsecurity.com/files/153159/Rapid7-Windows-InsightIDR-Agent-2.6.3.14-Local-Privilege-Escalation.html",
                        "refsource": "MISC",
                        "url": "http://packetstormsecurity.com/files/153159/Rapid7-Windows-InsightIDR-Agent-2.6.3.14-Local-Privilege-Escalation.html"
                    },
                    {
                        "name": "20190611 Rapid7's Windows InsightIDR Agent: Local Privilege Escalation",
                        "refsource": "FULLDISC",
                        "url": "http://seclists.org/fulldisclosure/2019/Jun/13"
                    },
                    {
                        "name": "https://help.rapid7.com/insightagent/release-notes/archive/2019/05/#20190529",
                        "refsource": "CONFIRM",
                        "url": "https://help.rapid7.com/insightagent/release-notes/archive/2019/05/#20190529"
                    },
                    {
                        "name": "https://bogner.sh/2019/06/local-privilege-escalation-in-rapid7s-windows-insight-idr-agent/",
                        "refsource": "MISC",
                        "url": "https://bogner.sh/2019/06/local-privilege-escalation-in-rapid7s-windows-insight-idr-agent/"
                    }
                ]
            },
            "solution": [
                {
                    "lang": "eng",
                    "value": "This issue affects Insight Agent instances at version 2.6.4 and older. Insight Agent will normally update automatically. Otherwise, if your Insight Agent instances are not running 2.6.5 or higher, ensure that you update all instances to 2.6.5 (or later if available)."
                }
            ],
            "source": {
                "advisory": "R7-2019-19",
                "discovery": "EXTERNAL"
            }
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:rapid7:insight_agent:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "2.6.3",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "cve@rapid7.com",
                    "ID": "CVE-2019-5629"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "Rapid7 Insight Agent, version 2.6.3 and prior, suffers from a local privilege escalation due to an uncontrolled DLL search path. Specifically, when Insight Agent 2.6.3 and prior starts, the Python interpreter attempts to load python3.dll at \"C:\\DLLs\\python3.dll,\" which normally is writable by locally authenticated users. Because of this, a malicious local user could use Insight Agent's startup conditions to elevate to SYSTEM privileges. This issue was fixed in Rapid7 Insight Agent 2.6.4."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-427"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "http://packetstormsecurity.com/files/153159/Rapid7-Windows-InsightIDR-Agent-2.6.3.14-Local-Privilege-Escalation.html",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory",
                                "VDB Entry"
                            ],
                            "url": "http://packetstormsecurity.com/files/153159/Rapid7-Windows-InsightIDR-Agent-2.6.3.14-Local-Privilege-Escalation.html"
                        },
                        {
                            "name": "https://help.rapid7.com/insightagent/release-notes/archive/2019/05/#20190529",
                            "refsource": "CONFIRM",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://help.rapid7.com/insightagent/release-notes/archive/2019/05/#20190529"
                        },
                        {
                            "name": "https://bogner.sh/2019/06/local-privilege-escalation-in-rapid7s-windows-insight-idr-agent/",
                            "refsource": "MISC",
                            "tags": [
                                "Exploit",
                                "Third Party Advisory"
                            ],
                            "url": "https://bogner.sh/2019/06/local-privilege-escalation-in-rapid7s-windows-insight-idr-agent/"
                        },
                        {
                            "name": "20190603 Rapid7's Windows InsightIDR Agent: Local Privilege Escalation",
                            "refsource": "BUGTRAQ",
                            "tags": [
                                "Issue Tracking",
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "https://seclists.org/bugtraq/2019/Jun/0"
                        },
                        {
                            "name": "20190611 Rapid7's Windows InsightIDR Agent: Local Privilege Escalation",
                            "refsource": "FULLDISC",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "http://seclists.org/fulldisclosure/2019/Jun/13"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV2": {
                    "acInsufInfo": false,
                    "cvssV2": {
                        "accessComplexity": "LOW",
                        "accessVector": "LOCAL",
                        "authentication": "NONE",
                        "availabilityImpact": "COMPLETE",
                        "baseScore": 7.2,
                        "confidentialityImpact": "COMPLETE",
                        "integrityImpact": "COMPLETE",
                        "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
                        "version": "2.0"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 10.0,
                    "obtainAllPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "obtainUserPrivilege": false,
                    "severity": "HIGH",
                    "userInteractionRequired": false
                },
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 1.8,
                    "impactScore": 5.9
                }
            },
            "lastModifiedDate": "2020-10-16T15:10Z",
            "publishedDate": "2019-07-13T01:15Z"
        }
    }
}