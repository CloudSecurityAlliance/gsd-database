{
  "GSD": {
    "alias": "CVE-2019-5420",
    "description": "A remote code execution vulnerability in development mode Rails <5.2.2.1, <6.0.0.beta3 can allow an attacker to guess the automatically generated development mode secret token. This secret token can be used in combination with other Rails internals to escalate to a remote code execution exploit.",
    "id": "GSD-2019-5420",
    "references": [
      "https://www.suse.com/security/cve/CVE-2019-5420.html",
      "https://packetstormsecurity.com/files/cve/CVE-2019-5420"
    ]
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "affected": [
        {
          "package": {
            "ecosystem": "RubyGems",
            "name": "railties",
            "purl": "pkg:gem/railties"
          }
        }
      ],
      "aliases": [
        "CVE-2019-5420",
        "GHSA-m42h-mh85-4qgc"
      ],
      "details": "There is a possible a possible remote code executing exploit in Rails when in\ndevelopment mode. This vulnerability has been assigned the CVE identifier\nCVE-2019-5420.\n\nVersions Affected:  6.0.0.X, 5.2.X.\nNot affected:       < 5.2.0\nFixed Versions:     6.0.0.beta3, 5.2.2.1\n\nImpact\n------\nWith some knowledge of a target application it is possible for an attacker to\nguess the automatically generated development mode secret token.  This secret\ntoken can be used in combination with other Rails internals to escalate to a\nremote code execution exploit.\n\nAll users running an affected release should either upgrade or use one of the\nworkarounds immediately.\n\nReleases\n--------\nThe 6.0.0.beta3 and 5.2.2.1 releases are available at the normal locations.\n\nWorkarounds\n-----------\nThis issue can be mitigated by specifying a secret key in development mode.\nIn \"config/environments/development.rb\" add this:\n\n  config.secret_key_base = SecureRandom.hex(64)\n\nCredits\n-------\nThanks to ooooooo_q\n",
      "id": "GSD-2019-5420",
      "modified": "2019-03-13T00:00:00.000Z",
      "published": "2019-03-13T00:00:00.000Z",
      "references": [
        {
          "type": "WEB",
          "url": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw"
        }
      ],
      "schema_version": "1.4.0",
      "severity": [
        {
          "score": 9.8,
          "type": "CVSS_V3"
        }
      ],
      "summary": "Possible Remote Code Execution Exploit in Rails Development Mode"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "support@hackerone.com",
        "ID": "CVE-2019-5420",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "https://github.com/rails/rails",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "5.2.2.1"
                        },
                        {
                          "version_value": "6.0.0.beta3"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "Rails"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "A remote code execution vulnerability in development mode Rails <5.2.2.1, <6.0.0.beta3 can allow an attacker to guess the automatically generated development mode secret token. This secret token can be used in combination with other Rails internals to escalate to a remote code execution exploit."
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "lang": "eng",
                "value": "Command Injection - Generic (CWE-77)"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/",
            "refsource": "CONFIRM",
            "url": "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/"
          },
          {
            "name": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw",
            "refsource": "CONFIRM",
            "url": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw"
          },
          {
            "name": "http://packetstormsecurity.com/files/152704/Ruby-On-Rails-DoubleTap-Development-Mode-secret_key_base-Remote-Code-Execution.html",
            "refsource": "MISC",
            "url": "http://packetstormsecurity.com/files/152704/Ruby-On-Rails-DoubleTap-Development-Mode-secret_key_base-Remote-Code-Execution.html"
          },
          {
            "name": "46785",
            "refsource": "EXPLOIT-DB",
            "url": "https://www.exploit-db.com/exploits/46785/"
          },
          {
            "name": "FEDORA-2019-1cfe24db5c",
            "refsource": "FEDORA",
            "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Y43636TH4D6T46IC6N2RQVJTRFJAAYGA/"
          }
        ]
      }
    },
    "github.com/rubysec/ruby-advisory-db": {
      "cve": "2019-5420",
      "cvss_v3": 9.8,
      "date": "2019-03-13",
      "description": "There is a possible a possible remote code executing exploit in Rails when in\ndevelopment mode. This vulnerability has been assigned the CVE identifier\nCVE-2019-5420.\n\nVersions Affected:  6.0.0.X, 5.2.X.\nNot affected:       < 5.2.0\nFixed Versions:     6.0.0.beta3, 5.2.2.1\n\nImpact\n------\nWith some knowledge of a target application it is possible for an attacker to\nguess the automatically generated development mode secret token.  This secret\ntoken can be used in combination with other Rails internals to escalate to a\nremote code execution exploit.\n\nAll users running an affected release should either upgrade or use one of the\nworkarounds immediately.\n\nReleases\n--------\nThe 6.0.0.beta3 and 5.2.2.1 releases are available at the normal locations.\n\nWorkarounds\n-----------\nThis issue can be mitigated by specifying a secret key in development mode.\nIn \"config/environments/development.rb\" add this:\n\n  config.secret_key_base = SecureRandom.hex(64)\n\nCredits\n-------\nThanks to ooooooo_q\n",
      "framework": "rails",
      "gem": "railties",
      "ghsa": "m42h-mh85-4qgc",
      "patched_versions": [
        "~> 5.2.2, >= 5.2.2.1",
        ">= 6.0.0.beta3"
      ],
      "title": "Possible Remote Code Execution Exploit in Rails Development Mode",
      "unaffected_versions": [
        "< 5.2.0"
      ],
      "url": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw"
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": ">=5.2.0 <5.2.2.1||>=6.0.0.beta1 <6.0.0",
          "affected_versions": "All versions starting from 5.2.0 before 5.2.2.1, all versions starting from 6.0.0.beta1 before 6.0.0",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-20",
            "CWE-937"
          ],
          "date": "2019-10-09",
          "description": "A remote code execution vulnerability in development mode Rails can allow an attacker to guess the automatically generated development mode secret token. This secret token can be used in combination with other Rails internals to escalate to a remote code execution exploit.",
          "fixed_versions": [
            "5.2.2.1",
            "6.0.0"
          ],
          "identifier": "CVE-2019-5420",
          "identifiers": [
            "CVE-2019-5420"
          ],
          "not_impacted": "All versions before 5.2.0, all versions starting from 5.2.2.1 before 6.0.0.beta1, all versions starting from 6.0.0",
          "package_slug": "gem/rails",
          "pubdate": "2019-03-27",
          "solution": "Upgrade to versions 5.2.2.1, 6.0.0 or above.",
          "title": "Improper Input Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2019-5420",
            "http://packetstormsecurity.com/files/152704/Ruby-On-Rails-DoubleTap-Development-Mode-secret_key_base-Remote-Code-Execution.html",
            "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/",
            "https://www.exploit-db.com/exploits/46785/"
          ],
          "uuid": "31ddd20a-862e-4bb9-a953-de04bb4c7caf"
        },
        {
          "affected_range": ">=5.2.0 <5.2.2.1||>=6.0.0.beta1 <6.0.0",
          "affected_versions": "All versions starting from 5.2.0 before 5.2.2.1, all versions starting from 6.0.0.beta1 before 6.0.0",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-20",
            "CWE-937"
          ],
          "date": "2019-10-09",
          "description": "A remote code execution vulnerability in development mode Rails can allow an attacker to guess the automatically generated development mode secret token. This secret token can be used in combination with other Rails internals to escalate to a remote code execution exploit.",
          "fixed_versions": [
            "5.2.2.1",
            "6.0.0"
          ],
          "identifier": "CVE-2019-5420",
          "identifiers": [
            "CVE-2019-5420"
          ],
          "not_impacted": "All versions before 5.2.0, all versions starting from 5.2.2.1 before 6.0.0.beta1, all versions starting from 6.0.0",
          "package_slug": "gem/railties",
          "pubdate": "2019-03-27",
          "solution": "Upgrade to versions 5.2.2.1, 6.0.0 or above.",
          "title": "Improper Input Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2019-5420",
            "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/",
            "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw"
          ],
          "uuid": "69d1c5e5-cf31-4cca-aa05-8e98a2f46f60"
        }
      ]
    },
    "nvd.nist.gov": {
      "configurations": {
        "CVE_data_version": "4.0",
        "nodes": [
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:a:rubyonrails:rails:6.0.0:beta1:*:*:*:*:*:*",
                "cpe_name": [],
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndExcluding": "5.2.2.1",
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:a:rubyonrails:rails:6.0.0:beta2:*:*:*:*:*:*",
                "cpe_name": [],
                "vulnerable": true
              }
            ],
            "operator": "OR"
          },
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*",
                "cpe_name": [],
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*",
                "cpe_name": [],
                "vulnerable": true
              }
            ],
            "operator": "OR"
          }
        ]
      },
      "cve": {
        "CVE_data_meta": {
          "ASSIGNER": "cve-assignments@hackerone.com",
          "ID": "CVE-2019-5420"
        },
        "data_format": "MITRE",
        "data_type": "CVE",
        "data_version": "4.0",
        "description": {
          "description_data": [
            {
              "lang": "en",
              "value": "A remote code execution vulnerability in development mode Rails <5.2.2.1, <6.0.0.beta3 can allow an attacker to guess the automatically generated development mode secret token. This secret token can be used in combination with other Rails internals to escalate to a remote code execution exploit."
            }
          ]
        },
        "problemtype": {
          "problemtype_data": [
            {
              "description": [
                {
                  "lang": "en",
                  "value": "CWE-330"
                }
              ]
            }
          ]
        },
        "references": {
          "reference_data": [
            {
              "name": "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/",
              "refsource": "CONFIRM",
              "tags": [
                "Patch",
                "Vendor Advisory"
              ],
              "url": "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/"
            },
            {
              "name": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw",
              "refsource": "CONFIRM",
              "tags": [
                "Mitigation",
                "Patch",
                "Third Party Advisory"
              ],
              "url": "https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw"
            },
            {
              "name": "http://packetstormsecurity.com/files/152704/Ruby-On-Rails-DoubleTap-Development-Mode-secret_key_base-Remote-Code-Execution.html",
              "refsource": "MISC",
              "tags": [
                "Exploit",
                "Third Party Advisory",
                "VDB Entry"
              ],
              "url": "http://packetstormsecurity.com/files/152704/Ruby-On-Rails-DoubleTap-Development-Mode-secret_key_base-Remote-Code-Execution.html"
            },
            {
              "name": "46785",
              "refsource": "EXPLOIT-DB",
              "tags": [
                "Exploit",
                "Third Party Advisory",
                "VDB Entry"
              ],
              "url": "https://www.exploit-db.com/exploits/46785/"
            },
            {
              "name": "FEDORA-2019-1cfe24db5c",
              "refsource": "FEDORA",
              "tags": [
                "Mailing List",
                "Third Party Advisory"
              ],
              "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Y43636TH4D6T46IC6N2RQVJTRFJAAYGA/"
            }
          ]
        }
      },
      "impact": {
        "baseMetricV2": {
          "acInsufInfo": false,
          "cvssV2": {
            "accessComplexity": "LOW",
            "accessVector": "NETWORK",
            "authentication": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5,
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "version": "2.0"
          },
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "obtainAllPrivilege": false,
          "obtainOtherPrivilege": false,
          "obtainUserPrivilege": false,
          "severity": "HIGH",
          "userInteractionRequired": false
        },
        "baseMetricV3": {
          "cvssV3": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      },
      "lastModifiedDate": "2021-11-03T18:19Z",
      "publishedDate": "2019-03-27T14:29Z"
    }
  }
}