{
  "GSD": {
    "alias": "CVE-2017-16653",
    "description": "An issue was discovered in Symfony before 2.7.38, 2.8.31, 3.2.14, 3.3.13, 3.4-BETA5, and 4.0-BETA5. The current implementation of CSRF protection in Symfony (Version >=2) does not use different tokens for HTTP and HTTPS; therefore the token is subject to MITM attacks on HTTP and can then be used in an HTTPS context to do CSRF attacks.",
    "id": "GSD-2017-16653",
    "references": [
      "https://www.debian.org/security/2018/dsa-4262"
    ]
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2017-16653"
      ],
      "details": "An issue was discovered in Symfony before 2.7.38, 2.8.31, 3.2.14, 3.3.13, 3.4-BETA5, and 4.0-BETA5. The current implementation of CSRF protection in Symfony (Version >=2) does not use different tokens for HTTP and HTTPS; therefore the token is subject to MITM attacks on HTTP and can then be used in an HTTPS context to do CSRF attacks.",
      "id": "GSD-2017-16653",
      "modified": "2023-12-13T01:21:00.855571Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "cve@mitre.org",
        "ID": "CVE-2017-16653",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "n/a",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "n/a"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "n/a"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "An issue was discovered in Symfony before 2.7.38, 2.8.31, 3.2.14, 3.3.13, 3.4-BETA5, and 4.0-BETA5. The current implementation of CSRF protection in Symfony (Version >=2) does not use different tokens for HTTP and HTTPS; therefore the token is subject to MITM attacks on HTTP and can then be used in an HTTPS context to do CSRF attacks."
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "lang": "eng",
                "value": "n/a"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://symfony.com/blog/cve-2017-16653-csrf-protection-does-not-use-different-tokens-for-http-and-https",
            "refsource": "CONFIRM",
            "url": "https://symfony.com/blog/cve-2017-16653-csrf-protection-does-not-use-different-tokens-for-http-and-https"
          },
          {
            "name": "https://github.com/symfony/symfony/pull/24992",
            "refsource": "CONFIRM",
            "url": "https://github.com/symfony/symfony/pull/24992"
          },
          {
            "name": "DSA-4262",
            "refsource": "DEBIAN",
            "url": "https://www.debian.org/security/2018/dsa-4262"
          }
        ]
      }
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": ">=v2.7.0-alpha0,<=v2.7.37||>=v2.8.0-alpha0,<=v2.8.30 ||>=v3.2.0-alpha0,<=v3.2.13||>=v3.3.0-alpha0,<=v3.3.12",
          "affected_versions": "All versions starting from v2.7.0-alpha0 up to v2.7.37, all versions starting from v2.8.0-alpha0 up to v2.8.30, all versions starting from v3.2.0-alpha0 up to v3.2.13, all versions starting from v3.3.0-alpha0 up to v3.3.12",
          "credit": "Oliver Hoff",
          "cvss_v2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "cvss_v3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "cwe_ids": [
            "CWE-1035",
            "CWE-937"
          ],
          "date": "2019-10-02",
          "description": "The implementation of CSRF protection did not use different tokens for HTTP and HTTPS, therefore the token was subject to MITM attacks on HTTP and could then be used in HTTPS context to do CSRF attacks.",
          "fixed_versions": [
            "v2.7.38",
            "v2.8.31",
            "v3.2.14",
            "v3.3.13",
            "v3.4-BETA5",
            "v4.0-BETA5"
          ],
          "identifier": "CVE-2017-16653",
          "identifiers": [
            "CVE-2017-16653"
          ],
          "not_impacted": "All versions before v2.7.0-alpha0, all versions after v2.7.37 before v2.8.0-alpha0, all versions after v2.8.30 before v3.2.0-alpha0, all versions after v3.2.13 before v3.3.0-alpha0, all versions after v3.3.12",
          "package_slug": "packagist/symfony/security-csrf",
          "pubdate": "2018-08-06",
          "solution": "Upgrade to versions v2.7.38, v2.8.31, v3.2.14, v3.3.13, v3.4-BETA5, v4.0-BETA5 or above.",
          "title": "CSRF vulnerability",
          "urls": [
            "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16653",
            "https://github.com/symfony/symfony/pull/24992"
          ],
          "uuid": "29d7b65e-fa05-40fe-9a30-a4410d27d2e6"
        },
        {
          "affected_range": ">=2.7.0,<2.7.38||>=2.8.0,<2.8.31||>=3.0.0,<3.2.14||>=3.3.0,<3.3.13",
          "affected_versions": "All versions starting from 2.7.0 before 2.7.38, all versions starting from 2.8.0 before 2.8.31, all versions starting from 3.0.0 before 3.2.14, all versions starting from 3.3.0 before 3.3.13",
          "cvss_v2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "cvss_v3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "cwe_ids": [
            "CWE-1035",
            "CWE-937"
          ],
          "date": "2019-10-02",
          "description": "The current implementation of CSRF protection in Symfony (Version >=2) does not use different tokens for HTTP and HTTPS; therefore the token is subject to MITM attacks on HTTP and can then be used in an HTTPS context to do CSRF attacks.",
          "fixed_versions": [
            "2.7.38",
            "2.8.31",
            "3.2.14",
            "3.3.13"
          ],
          "identifier": "CVE-2017-16653",
          "identifiers": [
            "CVE-2017-16653"
          ],
          "not_impacted": "All versions before 2.7.0, all versions starting from 2.7.38 before 2.8.0, all versions starting from 2.8.31 before 3.0.0, all versions starting from 3.2.14 before 3.3.0, all versions starting from 3.3.13",
          "package_slug": "packagist/symfony/security",
          "pubdate": "2018-08-06",
          "solution": "Upgrade to versions 2.7.38, 2.8.31, 3.2.14, 3.3.13 or above.",
          "title": "Channel Accessible by Non-Endpoint (Man-in-the-Middle)",
          "urls": [
            "https://symfony.com/cve-2017-16653"
          ],
          "uuid": "8932ef00-c272-4443-b017-6c9d81375aaf"
        },
        {
          "affected_range": ">=2.7.0,<=2.7.37||>=3.2.0,<=3.2.13||>=3.3.0,<=3.3.12||>=3.8.0,<=3.8.30",
          "affected_versions": "All versions starting from 2.7.0 up to 2.7.37, all versions starting from 3.2.0 up to 3.2.13, all versions starting from 3.3.0 up to 3.3.12, all versions starting from 3.8.0 up to 3.8.30",
          "credit": "Oliver Hoff",
          "cvss_v2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "cvss_v3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "cwe_ids": [
            "CWE-1035",
            "CWE-937"
          ],
          "date": "2019-10-03",
          "description": "The current implementation of CSRF protection in Symfony does not use different tokens for HTTP and HTTPS.",
          "fixed_versions": [
            "2.7.38",
            "3.2.14",
            "3.3.13",
            "4.0.0"
          ],
          "identifier": "CVE-2017-16653",
          "identifiers": [
            "CVE-2017-16653"
          ],
          "not_impacted": "All versions before 2.7.0, all versions after 2.7.37 before 3.2.0, all versions after 3.2.13 before 3.3.0, all versions after 3.3.12 before 3.8.0, all versions after 3.8.30",
          "package_slug": "packagist/symfony/symfony",
          "pubdate": "2018-08-06",
          "solution": "Upgrade to versions 2.7.38, 3.2.14, 3.3.13, 4.0.0 or above.",
          "title": "Cross-Site Request Forgery (CSRF)",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2017-16653",
            "https://github.com/symfony/symfony/pull/24992",
            "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16653"
          ],
          "uuid": "d7644a9f-dd71-434c-955a-c843099a8a6a"
        }
      ]
    },
    "nvd.nist.gov": {
      "configurations": {
        "CVE_data_version": "4.0",
        "nodes": [
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndIncluding": "2.7.37",
                "versionStartIncluding": "2.7.0",
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndIncluding": "3.8.30",
                "versionStartIncluding": "3.8.0",
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndIncluding": "3.2.13",
                "versionStartIncluding": "3.2.0",
                "vulnerable": true
              },
              {
                "cpe23Uri": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*",
                "cpe_name": [],
                "versionEndIncluding": "3.3.12",
                "versionStartIncluding": "3.3.0",
                "vulnerable": true
              }
            ],
            "operator": "OR"
          },
          {
            "children": [],
            "cpe_match": [
              {
                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
                "cpe_name": [],
                "vulnerable": true
              }
            ],
            "operator": "OR"
          }
        ]
      },
      "cve": {
        "CVE_data_meta": {
          "ASSIGNER": "cve@mitre.org",
          "ID": "CVE-2017-16653"
        },
        "data_format": "MITRE",
        "data_type": "CVE",
        "data_version": "4.0",
        "description": {
          "description_data": [
            {
              "lang": "en",
              "value": "An issue was discovered in Symfony before 2.7.38, 2.8.31, 3.2.14, 3.3.13, 3.4-BETA5, and 4.0-BETA5. The current implementation of CSRF protection in Symfony (Version >=2) does not use different tokens for HTTP and HTTPS; therefore the token is subject to MITM attacks on HTTP and can then be used in an HTTPS context to do CSRF attacks."
            }
          ]
        },
        "problemtype": {
          "problemtype_data": [
            {
              "description": [
                {
                  "lang": "en",
                  "value": "NVD-CWE-noinfo"
                }
              ]
            }
          ]
        },
        "references": {
          "reference_data": [
            {
              "name": "DSA-4262",
              "refsource": "DEBIAN",
              "tags": [
                "Third Party Advisory"
              ],
              "url": "https://www.debian.org/security/2018/dsa-4262"
            },
            {
              "name": "https://symfony.com/blog/cve-2017-16653-csrf-protection-does-not-use-different-tokens-for-http-and-https",
              "refsource": "CONFIRM",
              "tags": [
                "Issue Tracking",
                "Third Party Advisory"
              ],
              "url": "https://symfony.com/blog/cve-2017-16653-csrf-protection-does-not-use-different-tokens-for-http-and-https"
            },
            {
              "name": "https://github.com/symfony/symfony/pull/24992",
              "refsource": "CONFIRM",
              "tags": [
                "Issue Tracking",
                "Third Party Advisory"
              ],
              "url": "https://github.com/symfony/symfony/pull/24992"
            }
          ]
        }
      },
      "impact": {
        "baseMetricV2": {
          "cvssV2": {
            "accessComplexity": "MEDIUM",
            "accessVector": "NETWORK",
            "authentication": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.3,
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
            "version": "2.0"
          },
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "obtainAllPrivilege": false,
          "obtainOtherPrivilege": false,
          "obtainUserPrivilege": false,
          "severity": "MEDIUM",
          "userInteractionRequired": false
        },
        "baseMetricV3": {
          "cvssV3": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "version": "3.0"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        }
      },
      "lastModifiedDate": "2019-10-03T00:03Z",
      "publishedDate": "2018-08-06T21:29Z"
    }
  }
}