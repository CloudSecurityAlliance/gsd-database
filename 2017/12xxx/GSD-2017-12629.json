{
    "GSD": {
        "alias": "CVE-2017-12629",
        "description": "Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr.",
        "id": "GSD-2017-12629"
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "security@apache.org",
                "ID": "CVE-2017-12629",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Apache Solr before 7.1 with Apache Lucene before 7.1",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "Apache Solr before 7.1 with Apache Lucene before 7.1"
                                                },
                                                {
                                                    "version_affected": "<",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "7.1.0"
                                                },
                                                {
                                                    "version_affected": "<",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "6.6.2"
                                                },
                                                {
                                                    "version_affected": "<",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "5.5.5"
                                                },
                                                {
                                                    "version_affected": "!",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "7.2.0"
                                                },
                                                {
                                                    "version_affected": "!",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "8.0.0"
                                                },
                                                {
                                                    "platform": "redhat",
                                                    "version_affected": "<",
                                                    "version_name": "lucene-solr",
                                                    "version_value": "5.3.1-redhat-2"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "n/a"
                        }
                    ]
                }
            },
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr."
                    }
                ]
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "Remote code execution"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "RHSA-2017:3451",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2017:3451"
                    },
                    {
                        "name": "[lucene-dev] 20171012 Re: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)",
                        "refsource": "MLIST",
                        "url": "https://s.apache.org/FJDl"
                    },
                    {
                        "name": "RHSA-2018:0002",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2018:0002"
                    },
                    {
                        "name": "101261",
                        "refsource": "BID",
                        "url": "http://www.securityfocus.com/bid/101261"
                    },
                    {
                        "name": "RHSA-2018:0004",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2018:0004"
                    },
                    {
                        "name": "RHSA-2017:3452",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2017:3452"
                    },
                    {
                        "name": "[debian-lts-announce] 20180121 [SECURITY] [DLA 1254-1] lucene-solr security update",
                        "refsource": "MLIST",
                        "url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html"
                    },
                    {
                        "name": "43009",
                        "refsource": "EXPLOIT-DB",
                        "url": "https://www.exploit-db.com/exploits/43009/"
                    },
                    {
                        "name": "RHSA-2018:0003",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2018:0003"
                    },
                    {
                        "name": "RHSA-2017:3123",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2017:3123"
                    },
                    {
                        "name": "RHSA-2018:0005",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2018:0005"
                    },
                    {
                        "name": "RHSA-2017:3244",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2017:3244"
                    },
                    {
                        "name": "RHSA-2017:3124",
                        "refsource": "REDHAT",
                        "url": "https://access.redhat.com/errata/RHSA-2017:3124"
                    },
                    {
                        "name": "[www-announce] 20171019 [SECURITY] CVE-2017-12629: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)",
                        "refsource": "MLIST",
                        "url": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E"
                    },
                    {
                        "name": "DSA-4124",
                        "refsource": "DEBIAN",
                        "url": "https://www.debian.org/security/2018/dsa-4124"
                    },
                    {
                        "name": "USN-4259-1",
                        "refsource": "UBUNTU",
                        "url": "https://usn.ubuntu.com/4259-1/"
                    },
                    {
                        "name": "https://twitter.com/ApacheSolr/status/918731485611401216",
                        "refsource": "MISC",
                        "url": "https://twitter.com/ApacheSolr/status/918731485611401216"
                    },
                    {
                        "name": "https://twitter.com/searchtools_avi/status/918904813613543424",
                        "refsource": "MISC",
                        "url": "https://twitter.com/searchtools_avi/status/918904813613543424"
                    },
                    {
                        "name": "http://openwall.com/lists/oss-security/2017/10/13/1",
                        "refsource": "MISC",
                        "url": "http://openwall.com/lists/oss-security/2017/10/13/1"
                    },
                    {
                        "name": "https://twitter.com/joshbressers/status/919258716297420802",
                        "refsource": "MISC",
                        "url": "https://twitter.com/joshbressers/status/919258716297420802"
                    },
                    {
                        "name": "[solr-users] 20210618 CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef@%3Cusers.solr.apache.org%3E"
                    },
                    {
                        "name": "[solr-users] 20210618 Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc@%3Cusers.solr.apache.org%3E"
                    },
                    {
                        "name": "[solr-users] 20210728 Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314@%3Cusers.solr.apache.org%3E"
                    },
                    {
                        "name": "[jackrabbit-oak-issues] 20210817 [jira] [Created] (OAK-9537) Security vulnerability in org/apache/lucene/queryparser/xml/CoreParser.java",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f@%3Coak-issues.jackrabbit.apache.org%3E"
                    }
                ]
            }
        },
        "gitlab.com": {
            "advisories": [
                {
                    "affected_range": "[5.5.0,5.5.4],[6.0.0,6.0.1],[6.1.0,6.2.1],[6.3.0,6.4.2], [6.5.0,6.5.1],[6.6.0,6.6.1],[7.0.0,7.0.1]",
                    "affected_versions": "All versions starting from 5.5.0 up to 5.5.4, all versions starting from 6.0.0 up to 6.0.1, all versions starting from 6.1.0 up to 6.2.1, all versions starting from 6.3.0 up to 6.4.2, all versions starting from 6.5.0 up to 6.5.1, all versions starting from 6.6.0 up to 6.6.1, all versions starting from 7.0.0 up to 7.0.1",
                    "credit": "Nicolas Gr\u00e9goire",
                    "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                    "cvss_v3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-611",
                        "CWE-937"
                    ],
                    "date": "2018-03-01",
                    "description": "Remote code execution is possible in Apache Solr.",
                    "fixed_versions": [
                        "5.5.5",
                        "6.6.2",
                        "7.1.0"
                    ],
                    "identifier": "CVE-2017-12629",
                    "identifiers": [
                        "CVE-2017-12629"
                    ],
                    "not_impacted": "All versions before 5.5.0, all versions after 5.5.4 before 6.0.0, all versions after 6.0.1 before 6.1.0, all versions after 6.2.1 before 6.3.0, all versions after 6.4.2 before 6.5.0, all versions after 6.5.1 before 6.6.0, all versions after 6.6.1 before 7.0.0, all versions after 7.0.1",
                    "package_slug": "maven/org.apache.solr/solr-core",
                    "pubdate": "2017-10-14",
                    "solution": "Upgrade to versions 5.5.5, 6.6.2, 7.1.0 or above.",
                    "title": "Remote code execution",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2017-12629",
                        "http://www.securityfocus.com/bid/101261",
                        "https://s.apache.org/FJDl",
                        "https://www.exploit-db.com/exploits/43009/",
                        "http://www.cvedetails.com/cve/CVE-2017-12629/",
                        "https://github.com/AsyncHttpClient/async-http-client/issues/1455"
                    ],
                    "uuid": "9dabb94a-776f-47f6-bb99-43a6130dc743"
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "5.5.4",
                                "versionStartIncluding": "5.5.0",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "6.6.1",
                                "versionStartIncluding": "6.0.0",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "7.0.1",
                                "versionStartIncluding": "7.0.0",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [
                            {
                                "children": [],
                                "cpe_match": [
                                    {
                                        "cpe23Uri": "cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.0.0:*:*:*:*:*:*:*",
                                        "cpe_name": [],
                                        "vulnerable": true
                                    },
                                    {
                                        "cpe23Uri": "cpe:2.3:a:redhat:jboss_enterprise_application_platform:7.1.0:*:*:*:*:*:*:*",
                                        "cpe_name": [],
                                        "vulnerable": true
                                    }
                                ],
                                "operator": "OR"
                            },
                            {
                                "children": [],
                                "cpe_match": [
                                    {
                                        "cpe23Uri": "cpe:2.3:o:redhat:enterprise_linux_server:6.0:*:*:*:*:*:*:*",
                                        "cpe_name": [],
                                        "vulnerable": false
                                    },
                                    {
                                        "cpe23Uri": "cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*",
                                        "cpe_name": [],
                                        "vulnerable": false
                                    }
                                ],
                                "operator": "OR"
                            }
                        ],
                        "cpe_match": [],
                        "operator": "AND"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "security@apache.org",
                    "ID": "CVE-2017-12629"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-611"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://twitter.com/searchtools_avi/status/918904813613543424",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://twitter.com/searchtools_avi/status/918904813613543424"
                        },
                        {
                            "name": "https://twitter.com/joshbressers/status/919258716297420802",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://twitter.com/joshbressers/status/919258716297420802"
                        },
                        {
                            "name": "https://twitter.com/ApacheSolr/status/918731485611401216",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://twitter.com/ApacheSolr/status/918731485611401216"
                        },
                        {
                            "name": "http://openwall.com/lists/oss-security/2017/10/13/1",
                            "refsource": "MISC",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "http://openwall.com/lists/oss-security/2017/10/13/1"
                        },
                        {
                            "name": "101261",
                            "refsource": "BID",
                            "tags": [
                                "Third Party Advisory",
                                "VDB Entry"
                            ],
                            "url": "http://www.securityfocus.com/bid/101261"
                        },
                        {
                            "name": "43009",
                            "refsource": "EXPLOIT-DB",
                            "tags": [
                                "Exploit",
                                "Third Party Advisory",
                                "VDB Entry"
                            ],
                            "url": "https://www.exploit-db.com/exploits/43009/"
                        },
                        {
                            "name": "[lucene-dev] 20171012 Re: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)",
                            "refsource": "MLIST",
                            "tags": [
                                "Exploit",
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://s.apache.org/FJDl"
                        },
                        {
                            "name": "[www-announce] 20171019 [SECURITY] CVE-2017-12629: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E"
                        },
                        {
                            "name": "RHSA-2017:3244",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2017:3244"
                        },
                        {
                            "name": "RHSA-2017:3124",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2017:3124"
                        },
                        {
                            "name": "RHSA-2017:3123",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2017:3123"
                        },
                        {
                            "name": "RHSA-2017:3452",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2017:3452"
                        },
                        {
                            "name": "RHSA-2017:3451",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2017:3451"
                        },
                        {
                            "name": "RHSA-2018:0005",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2018:0005"
                        },
                        {
                            "name": "RHSA-2018:0004",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2018:0004"
                        },
                        {
                            "name": "RHSA-2018:0003",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2018:0003"
                        },
                        {
                            "name": "RHSA-2018:0002",
                            "refsource": "REDHAT",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://access.redhat.com/errata/RHSA-2018:0002"
                        },
                        {
                            "name": "[debian-lts-announce] 20180121 [SECURITY] [DLA 1254-1] lucene-solr security update",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html"
                        },
                        {
                            "name": "DSA-4124",
                            "refsource": "DEBIAN",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://www.debian.org/security/2018/dsa-4124"
                        },
                        {
                            "name": "USN-4259-1",
                            "refsource": "UBUNTU",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://usn.ubuntu.com/4259-1/"
                        },
                        {
                            "name": "[solr-users] 20210618 CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                            "refsource": "MLIST",
                            "tags": [],
                            "url": "https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef@%3Cusers.solr.apache.org%3E"
                        },
                        {
                            "name": "[solr-users] 20210618 Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                            "refsource": "MLIST",
                            "tags": [],
                            "url": "https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc@%3Cusers.solr.apache.org%3E"
                        },
                        {
                            "name": "[solr-users] 20210728 Re: CVE-2021-27905 Apache Solr ReplicationHandler/SSRF vulnerability",
                            "refsource": "MLIST",
                            "tags": [],
                            "url": "https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314@%3Cusers.solr.apache.org%3E"
                        },
                        {
                            "name": "[jackrabbit-oak-issues] 20210817 [jira] [Created] (OAK-9537) Security vulnerability in org/apache/lucene/queryparser/xml/CoreParser.java",
                            "refsource": "MLIST",
                            "tags": [],
                            "url": "https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f@%3Coak-issues.jackrabbit.apache.org%3E"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV2": {
                    "cvssV2": {
                        "accessComplexity": "LOW",
                        "accessVector": "NETWORK",
                        "authentication": "NONE",
                        "availabilityImpact": "PARTIAL",
                        "baseScore": 7.5,
                        "confidentialityImpact": "PARTIAL",
                        "integrityImpact": "PARTIAL",
                        "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                        "version": "2.0"
                    },
                    "exploitabilityScore": 10.0,
                    "impactScore": 6.4,
                    "obtainAllPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "obtainUserPrivilege": false,
                    "severity": "HIGH",
                    "userInteractionRequired": false
                },
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 9.8,
                        "baseSeverity": "CRITICAL",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 5.9
                }
            },
            "lastModifiedDate": "2021-08-17T13:15Z",
            "publishedDate": "2017-10-14T23:29Z"
        }
    }
}