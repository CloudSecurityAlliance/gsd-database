{
    "GSD": {
        "alias": "CVE-2021-35516",
        "description": "When reading a specially crafted 7Z archive, Compress can be made to allocate large amounts of memory that finally leads to an out of memory error even for very small inputs. This could be used to mount a denial of service attack against services that use Compress' sevenz package.",
        "id": "GSD-2021-35516"
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "security@apache.org",
                "ID": "CVE-2021-35516",
                "STATE": "PUBLIC",
                "TITLE": "Apache Commons Compress 1.6 to 1.20 denial of service vulnerability"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Apache Commons Compress",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_affected": ">=",
                                                    "version_name": "Apache Commons Compress",
                                                    "version_value": "1.6"
                                                },
                                                {
                                                    "version_affected": "<=",
                                                    "version_name": "Apache Commons Compress",
                                                    "version_value": "1.20"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "Apache Software Foundation"
                        }
                    ]
                }
            },
            "credit": [
                {
                    "lang": "eng",
                    "value": "This issue was first reported to the project's issue tracker as COMPRESS-542 by Robin Schimpf. Later OSS Fuzz detected ways to exploit this issue which managed to escape the initial attempt to fix it."
                }
            ],
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "When reading a specially crafted 7Z archive, Compress can be made to allocate large amounts of memory that finally leads to an out of memory error even for very small inputs. This could be used to mount a denial of service attack against services that use Compress' sevenz package."
                    }
                ]
            },
            "generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "impact": [
                {
                    "other": "low"
                }
            ],
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "CWE-130 Improper Handling of Length Parameter Inconsistency "
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://commons.apache.org/proper/commons-compress/security-reports.html",
                        "refsource": "MISC",
                        "url": "https://commons.apache.org/proper/commons-compress/security-reports.html"
                    },
                    {
                        "name": "https://lists.apache.org/thread.html/rf68442d67eb166f4b6cf0bbbe6c7f99098c12954f37332073c9822ca%40%3Cuser.commons.apache.org%3E",
                        "refsource": "MISC",
                        "url": "https://lists.apache.org/thread.html/rf68442d67eb166f4b6cf0bbbe6c7f99098c12954f37332073c9822ca%40%3Cuser.commons.apache.org%3E"
                    },
                    {
                        "name": "[oss-security] 20210713 CVE-2021-35516: Apache Commons Compress 1.6 to 1.20 denial of service vulnerability",
                        "refsource": "MLIST",
                        "url": "http://www.openwall.com/lists/oss-security/2021/07/13/2"
                    },
                    {
                        "name": "[announce] 20210713 CVE-2021-35516: Apache Commons Compress 1.6 to 1.20 denial of service vulnerability",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rf5b1016fb15b7118b9a5e16bb0b78cb4f1dfcf7821eb137ab5757c91@%3Cannounce.apache.org%3E"
                    },
                    {
                        "name": "[pulsar-commits] 20210716 [GitHub] [pulsar] lhotari opened a new pull request #11345: [Security] Upgrade commons-compress to 1.21",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rb064d705fdfa44b5dae4c366b369ef6597951083196321773b983e71@%3Ccommits.pulsar.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] wu-sheng opened a new pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rd4332baaf6debd03d60deb7ec93bee49e5fdbe958cb6800dff7fb00e@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210802 [skywalking] 01/01: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rb7adf3e55359819e77230b4586521e5c6874ce5ed93384bdc14d6aee@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210803 [skywalking] branch master updated: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090 (#7400)",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rfba19167efc785ad3561e7ef29f340d65ac8f0d897aed00e0731e742@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210803 [GitHub] [skywalking] hanahmily merged pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rba65ed5ddb0586f5b12598f55ec7db3633e7b7fede60466367fbf86a@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210803 [GitHub] [skywalking] codecov[bot] edited a comment on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r9f54c0caa462267e0cc68b49f141e91432b36b23348d18c65bd0d040@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] codecov[bot] commented on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/racd0c0381c8404f298b226cd9db2eaae965b14c9c568224aa3f437ae@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] codecov[bot] edited a comment on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/rb6e1fa80d34e5ada45f72655d84bfd90db0ca44ef19236a49198c88c@%3Cnotifications.skywalking.apache.org%3E"
                    },
                    {
                        "name": "[poi-dev] 20210923 Re: [VOTE] Apache POI 5.1.0 release (RC1)",
                        "refsource": "MLIST",
                        "url": "https://lists.apache.org/thread.html/r67ef3c07fe3b8c1b02d48012149d280ad6da8e4cec253b527520fb2b@%3Cdev.poi.apache.org%3E"
                    },
                    {
                        "name": "https://www.oracle.com/security-alerts/cpuoct2021.html",
                        "refsource": "MISC",
                        "url": "https://www.oracle.com/security-alerts/cpuoct2021.html"
                    },
                    {
                        "name": "https://www.oracle.com/security-alerts/cpujan2022.html",
                        "refsource": "MISC",
                        "url": "https://www.oracle.com/security-alerts/cpujan2022.html"
                    },
                    {
                        "name": "https://security.netapp.com/advisory/ntap-20211022-0001/",
                        "refsource": "CONFIRM",
                        "url": "https://security.netapp.com/advisory/ntap-20211022-0001/"
                    }
                ]
            },
            "source": {
                "defect": [
                    "COMPRESS-542"
                ],
                "discovery": "UNKNOWN"
            },
            "work_around": [
                {
                    "lang": "eng",
                    "value": "Commons Compress users should upgrade to 1.21 or later.\n\nWith Compress 1.19 we introduced a feature that tries to recover broken 7z archives, which makes it far easier to exploit this weakness. As a result we have disabled the recovery code by default and users need to enable it explicitly. In addition users are able to control the amount of memory SevenZFile may use and we strongly recommend using this feature when trying to recover broken archives.\n"
                }
            ]
        },
        "gitlab.com": {
            "advisories": [
                {
                    "affected_range": "[1.6,1.20]",
                    "affected_versions": "All versions starting from 1.6 up to 1.20",
                    "cvss_v2": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-770",
                        "CWE-937"
                    ],
                    "date": "2022-02-07",
                    "description": "When reading a specially crafted 7Z archive, Compress can be made to allocate large amounts of memory that finally leads to an out of memory error even for very small inputs. This could be used to mount a denial of service attack against services that use Compress' sevenz package.",
                    "fixed_versions": [
                        "1.21"
                    ],
                    "identifier": "CVE-2021-35516",
                    "identifiers": [
                        "CVE-2021-35516"
                    ],
                    "not_impacted": "All versions before 1.6, all versions after 1.20",
                    "package_slug": "maven/org.apache.commons/commons-compress",
                    "pubdate": "2021-07-13",
                    "solution": "Upgrade to version 1.21 or above.",
                    "title": "Uncontrolled Resource Consumption",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2021-35516",
                        "https://commons.apache.org/proper/commons-compress/security-reports.html"
                    ],
                    "uuid": "487c8f4e-8fee-4036-bb28-541157d26ed6"
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:commons_compress:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "1.20",
                                "versionStartIncluding": "1.6",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:linux:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:vmware_vsphere:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:windows:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:netapp:oncommand_insight:-:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:communications_session_route_manager:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "8.2.5",
                                "versionStartIncluding": "8.0.0",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:financial_services_enterprise_case_management:8.0.7.2.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:financial_services_enterprise_case_management:8.0.8.1.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:peoplesoft_enterprise_peopletools:8.57:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:peoplesoft_enterprise_peopletools:8.58:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:peoplesoft_enterprise_peopletools:8.59:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:primavera_unifier:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "17.12",
                                "versionStartIncluding": "17.7",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:primavera_unifier:18.8:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:primavera_unifier:19.12:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:oracle:primavera_unifier:20.12:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:o:oracle:communications_messaging_server:8.1:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "security@apache.org",
                    "ID": "CVE-2021-35516"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "When reading a specially crafted 7Z archive, Compress can be made to allocate large amounts of memory that finally leads to an out of memory error even for very small inputs. This could be used to mount a denial of service attack against services that use Compress' sevenz package."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-770"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://commons.apache.org/proper/commons-compress/security-reports.html",
                            "refsource": "MISC",
                            "tags": [
                                "Vendor Advisory"
                            ],
                            "url": "https://commons.apache.org/proper/commons-compress/security-reports.html"
                        },
                        {
                            "name": "https://lists.apache.org/thread.html/rf68442d67eb166f4b6cf0bbbe6c7f99098c12954f37332073c9822ca%40%3Cuser.commons.apache.org%3E",
                            "refsource": "MISC",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rf68442d67eb166f4b6cf0bbbe6c7f99098c12954f37332073c9822ca%40%3Cuser.commons.apache.org%3E"
                        },
                        {
                            "name": "[oss-security] 20210713 CVE-2021-35516: Apache Commons Compress 1.6 to 1.20 denial of service vulnerability",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "http://www.openwall.com/lists/oss-security/2021/07/13/2"
                        },
                        {
                            "name": "[announce] 20210713 CVE-2021-35516: Apache Commons Compress 1.6 to 1.20 denial of service vulnerability",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rf5b1016fb15b7118b9a5e16bb0b78cb4f1dfcf7821eb137ab5757c91@%3Cannounce.apache.org%3E"
                        },
                        {
                            "name": "[pulsar-commits] 20210716 [GitHub] [pulsar] lhotari opened a new pull request #11345: [Security] Upgrade commons-compress to 1.21",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rb064d705fdfa44b5dae4c366b369ef6597951083196321773b983e71@%3Ccommits.pulsar.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] wu-sheng opened a new pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Exploit",
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rd4332baaf6debd03d60deb7ec93bee49e5fdbe958cb6800dff7fb00e@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210802 [skywalking] 01/01: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Patch",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rb7adf3e55359819e77230b4586521e5c6874ce5ed93384bdc14d6aee@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210803 [skywalking] branch master updated: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090 (#7400)",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Patch",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rfba19167efc785ad3561e7ef29f340d65ac8f0d897aed00e0731e742@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210803 [GitHub] [skywalking] codecov[bot] edited a comment on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Patch",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/r9f54c0caa462267e0cc68b49f141e91432b36b23348d18c65bd0d040@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210803 [GitHub] [skywalking] hanahmily merged pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rba65ed5ddb0586f5b12598f55ec7db3633e7b7fede60466367fbf86a@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] codecov[bot] commented on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Patch",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/racd0c0381c8404f298b226cd9db2eaae965b14c9c568224aa3f437ae@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[skywalking-notifications] 20210802 [GitHub] [skywalking] codecov[bot] edited a comment on pull request #7400: Fix CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Patch",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/rb6e1fa80d34e5ada45f72655d84bfd90db0ca44ef19236a49198c88c@%3Cnotifications.skywalking.apache.org%3E"
                        },
                        {
                            "name": "[poi-dev] 20210923 Re: [VOTE] Apache POI 5.1.0 release (RC1)",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Vendor Advisory"
                            ],
                            "url": "https://lists.apache.org/thread.html/r67ef3c07fe3b8c1b02d48012149d280ad6da8e4cec253b527520fb2b@%3Cdev.poi.apache.org%3E"
                        },
                        {
                            "name": "https://www.oracle.com/security-alerts/cpuoct2021.html",
                            "refsource": "MISC",
                            "tags": [
                                "Patch",
                                "Third Party Advisory"
                            ],
                            "url": "https://www.oracle.com/security-alerts/cpuoct2021.html"
                        },
                        {
                            "name": "https://security.netapp.com/advisory/ntap-20211022-0001/",
                            "refsource": "CONFIRM",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://security.netapp.com/advisory/ntap-20211022-0001/"
                        },
                        {
                            "name": "https://www.oracle.com/security-alerts/cpujan2022.html",
                            "refsource": "MISC",
                            "tags": [],
                            "url": "https://www.oracle.com/security-alerts/cpujan2022.html"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV2": {
                    "acInsufInfo": false,
                    "cvssV2": {
                        "accessComplexity": "LOW",
                        "accessVector": "NETWORK",
                        "authentication": "NONE",
                        "availabilityImpact": "PARTIAL",
                        "baseScore": 5.0,
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
                        "version": "2.0"
                    },
                    "exploitabilityScore": 10.0,
                    "impactScore": 2.9,
                    "obtainAllPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "obtainUserPrivilege": false,
                    "severity": "MEDIUM",
                    "userInteractionRequired": false
                },
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 3.6
                }
            },
            "lastModifiedDate": "2022-02-07T16:16Z",
            "publishedDate": "2021-07-13T08:15Z"
        }
    }
}