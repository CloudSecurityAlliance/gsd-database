{
    "GSD": {
        "alias": "CVE-2021-21333",
        "description": "Synapse is a Matrix reference homeserver written in python (pypi package matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and VoIP. In Synapse before version 1.27.0, the notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email. The account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker. This is fixed in version 1.27.0.",
        "id": "GSD-2021-21333"
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "security-advisories@github.com",
                "ID": "CVE-2021-21333",
                "STATE": "PUBLIC",
                "TITLE": "HTML injection in email and account expiry notifications"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "synapse",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "< 1.27.0"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "matrix-org"
                        }
                    ]
                }
            },
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Synapse is a Matrix reference homeserver written in python (pypi package matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and VoIP. In Synapse before version 1.27.0, the notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email. The account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker. This is fixed in version 1.27.0."
                    }
                ]
            },
            "impact": {
                "cvss": {
                    "attackComplexity": "HIGH",
                    "attackVector": "NETWORK",
                    "availabilityImpact": "NONE",
                    "baseScore": 6.1,
                    "baseSeverity": "MEDIUM",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "HIGH",
                    "privilegesRequired": "NONE",
                    "scope": "CHANGED",
                    "userInteraction": "REQUIRED",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N",
                    "version": "3.1"
                }
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "CWE-74 Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://github.com/matrix-org/synapse/releases/tag/v1.27.0",
                        "refsource": "MISC",
                        "url": "https://github.com/matrix-org/synapse/releases/tag/v1.27.0"
                    },
                    {
                        "name": "https://github.com/matrix-org/synapse/pull/9200",
                        "refsource": "MISC",
                        "url": "https://github.com/matrix-org/synapse/pull/9200"
                    },
                    {
                        "name": "https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df",
                        "refsource": "MISC",
                        "url": "https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df"
                    },
                    {
                        "name": "https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm",
                        "refsource": "CONFIRM",
                        "url": "https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm"
                    },
                    {
                        "name": "FEDORA-2021-a627cfd31e",
                        "refsource": "FEDORA",
                        "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY/"
                    }
                ]
            },
            "source": {
                "advisory": "GHSA-c5f8-35qr-q4fm",
                "discovery": "UNKNOWN"
            }
        },
        "gitlab.com": {
            "advisories": [
                {
                    "affected_range": "<1.27.0",
                    "affected_versions": "All versions before 1.27.0",
                    "cvss_v2": "AV:N/AC:H/Au:N/C:N/I:P/A:N",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-74",
                        "CWE-937"
                    ],
                    "date": "2021-11-23",
                    "description": "Synapse is a Matrix reference homeserver written in python. Matrix is an ecosystem for open federated Instant Messaging and VoIP. In Synapse, the notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email. The account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker.",
                    "fixed_versions": [
                        "1.27.0"
                    ],
                    "identifier": "CVE-2021-21333",
                    "identifiers": [
                        "CVE-2021-21333",
                        "GHSA-c5f8-35qr-q4fm"
                    ],
                    "not_impacted": "All versions starting from 1.27.0",
                    "package_slug": "pypi/matrix-synapse",
                    "pubdate": "2021-03-26",
                    "solution": "Upgrade to version 1.27.0 or above.",
                    "title": "Injection Vulnerability",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2021-21333"
                    ],
                    "uuid": "66a58fb8-8782-4859-aaae-4ed1eeec5316"
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndExcluding": "1.27.0",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "security-advisories@github.com",
                    "ID": "CVE-2021-21333"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "Synapse is a Matrix reference homeserver written in python (pypi package matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and VoIP. In Synapse before version 1.27.0, the notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email. The account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker. This is fixed in version 1.27.0."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-74"
                                },
                                {
                                    "lang": "en",
                                    "value": "CWE-74"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://github.com/matrix-org/synapse/pull/9200",
                            "refsource": "MISC",
                            "tags": [
                                "Patch",
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/matrix-org/synapse/pull/9200"
                        },
                        {
                            "name": "https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df",
                            "refsource": "MISC",
                            "tags": [
                                "Patch",
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df"
                        },
                        {
                            "name": "https://github.com/matrix-org/synapse/releases/tag/v1.27.0",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/matrix-org/synapse/releases/tag/v1.27.0"
                        },
                        {
                            "name": "https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm",
                            "refsource": "CONFIRM",
                            "tags": [
                                "Patch",
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm"
                        },
                        {
                            "name": "FEDORA-2021-a627cfd31e",
                            "refsource": "FEDORA",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY/"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV2": {
                    "acInsufInfo": false,
                    "cvssV2": {
                        "accessComplexity": "HIGH",
                        "accessVector": "NETWORK",
                        "authentication": "NONE",
                        "availabilityImpact": "NONE",
                        "baseScore": 2.6,
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "PARTIAL",
                        "vectorString": "AV:N/AC:H/Au:N/C:N/I:P/A:N",
                        "version": "2.0"
                    },
                    "exploitabilityScore": 4.9,
                    "impactScore": 2.9,
                    "obtainAllPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "obtainUserPrivilege": false,
                    "severity": "LOW",
                    "userInteractionRequired": true
                },
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "HIGH",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 6.1,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "NONE",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 1.6,
                    "impactScore": 4.0
                }
            },
            "lastModifiedDate": "2021-11-23T22:32Z",
            "publishedDate": "2021-03-26T20:15Z"
        }
    }
}