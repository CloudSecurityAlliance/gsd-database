{
  "GSD": {
    "alias": "CVE-2021-40828",
    "description": "Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3), Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows.",
    "id": "GSD-2021-40828"
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2021-40828"
      ],
      "details": "Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3), Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows.",
      "id": "GSD-2021-40828",
      "modified": "2023-12-13T01:23:25.262064Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "cve-notifications-us@f-secure.com",
        "ID": "CVE-2021-40828",
        "STATE": "PUBLIC",
        "TITLE": "TLS hostname validation issues within AWS IoT Device SDKs on Windows"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "AWS IoT Device SDK v2 for Java ",
                    "version": {
                      "version_data": [
                        {
                          "platform": "Microsoft Windows",
                          "version_affected": "<",
                          "version_value": "1.3.3"
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "AWS IoT Device SDK v2 for Python",
                    "version": {
                      "version_data": [
                        {
                          "platform": "Microsoft Windows",
                          "version_affected": "<",
                          "version_value": "1.5.18"
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "AWS IoT Device SDK v2 for C++",
                    "version": {
                      "version_data": [
                        {
                          "platform": "Microsoft Windows",
                          "version_affected": "<",
                          "version_value": "1.12.7"
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "AWS IoT Device SDK v2 for Node.js",
                    "version": {
                      "version_data": [
                        {
                          "platform": "Microsoft Windows",
                          "version_affected": "<",
                          "version_value": "1.5.3"
                        }
                      ]
                    }
                  },
                  {
                    "product_name": "AWS-C-IO",
                    "version": {
                      "version_data": [
                        {
                          "platform": "Microsoft Windows",
                          "version_value": "0.9.12"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "Amazon Web Services"
            }
          ]
        }
      },
      "credit": [
        {
          "lang": "eng",
          "value": "F-Secure"
        }
      ],
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3), Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows."
          }
        ]
      },
      "generator": {
        "engine": "Vulnogram 0.0.9"
      },
      "impact": {
        "cvss": {
          "attackComplexity": "HIGH",
          "attackVector": "ADJACENT_NETWORK",
          "availabilityImpact": "HIGH",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "privilegesRequired": "HIGH",
          "scope": "UNCHANGED",
          "userInteraction": "REQUIRED",
          "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H",
          "version": "3.1"
        }
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "lang": "eng",
                "value": "Connections initialized by the AWS IoT Device SDK v2 for Java, Python, C++ and Node.js did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. "
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://github.com/awslabs/aws-c-io/",
            "refsource": "MISC",
            "url": "https://github.com/awslabs/aws-c-io/"
          },
          {
            "name": "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
            "refsource": "MISC",
            "url": "https://github.com/aws/aws-iot-device-sdk-cpp-v2"
          },
          {
            "name": "https://github.com/aws/aws-iot-device-sdk-python-v2",
            "refsource": "MISC",
            "url": "https://github.com/aws/aws-iot-device-sdk-python-v2"
          },
          {
            "name": "https://github.com/aws/aws-iot-device-sdk-java-v2",
            "refsource": "MISC",
            "url": "https://github.com/aws/aws-iot-device-sdk-java-v2"
          },
          {
            "name": "https://github.com/aws/aws-iot-device-sdk-js-v2",
            "refsource": "MISC",
            "url": "https://github.com/aws/aws-iot-device-sdk-js-v2"
          }
        ]
      },
      "solution": [
        {
          "lang": "eng",
          "value": "Update to the latest versions of the AWS IoT Device SDK."
        }
      ],
      "source": {
        "discovery": "INTERNAL"
      }
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": "[,1.3.3)",
          "affected_versions": "All versions before 1.3.3",
          "cvss_v2": "AV:A/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-295",
            "CWE-937"
          ],
          "date": "2021-12-02",
          "description": "Connections initialized by the AWS IoT Device SDK v2 for Java, Python , C++ and Node.js does not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js on Microsoft Windows.",
          "fixed_versions": [
            "1.3.3"
          ],
          "identifier": "CVE-2021-40828",
          "identifiers": [
            "CVE-2021-40828"
          ],
          "not_impacted": "All versions starting from 1.3.3",
          "package_slug": "maven/com.amazonaws/aws-iot-device-sdk-java",
          "pubdate": "2021-11-23",
          "solution": "Upgrade to version 1.3.3 or above.",
          "title": "Improper Certificate Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-40828",
            "https://github.com/aws/aws-iot-device-sdk-js-v2",
            "https://github.com/awslabs/aws-c-io/",
            "https://github.com/aws/aws-iot-device-sdk-python-v2",
            "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
            "https://github.com/aws/aws-iot-device-sdk-java-v2"
          ],
          "uuid": "d20fdc0f-a7e4-4c8b-aab8-c991ad7c0d08"
        },
        {
          "affected_range": "(,1.3.3)",
          "affected_versions": "All versions before 1.3.3",
          "cvss_v2": "AV:A/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-295",
            "CWE-937"
          ],
          "date": "2021-12-03",
          "description": "Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3), Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows.",
          "fixed_versions": [
            "1.3.3"
          ],
          "identifier": "CVE-2021-40828",
          "identifiers": [
            "GHSA-94jq-q5v2-76wj",
            "CVE-2021-40828"
          ],
          "not_impacted": "All versions starting from 1.3.3",
          "package_slug": "maven/software.amazon.awssdk.iotdevicesdk/aws-iot-device-sdk",
          "pubdate": "2021-11-24",
          "solution": "Upgrade to version 1.3.3 or above.",
          "title": "Improper Certificate Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-40828",
            "https://github.com/aws/aws-iot-device-sdk-java-v2/commit/67950ad2a02f2f9355c310b69dc9226b017f32f2",
            "https://github.com/aws/aws-iot-device-sdk-js-v2/commit/4be41394f1aee979e6f4b012fcb01eecabd0c08d",
            "https://github.com/aws/aws-iot-device-sdk-python-v2/commit/fd4c0ba04b35eab9e20c635af5548fcc5a92d8be",
            "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
            "https://github.com/aws/aws-iot-device-sdk-java-v2",
            "https://github.com/aws/aws-iot-device-sdk-js-v2",
            "https://github.com/aws/aws-iot-device-sdk-python-v2",
            "https://github.com/awslabs/aws-c-io/",
            "https://github.com/advisories/GHSA-94jq-q5v2-76wj"
          ],
          "uuid": "7418b3fb-84cb-422a-8073-7056d6feca7a"
        },
        {
          "affected_range": "<1.5.1",
          "affected_versions": "All versions before 1.5.1",
          "cvss_v2": "AV:A/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-295",
            "CWE-937"
          ],
          "date": "2021-12-02",
          "description": "Connections initialized by the AWS IoT Device SDK v2 for Java, Python, C++ and Node.js does not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js on Microsoft Windows.",
          "fixed_versions": [
            "1.5.1"
          ],
          "identifier": "CVE-2021-40828",
          "identifiers": [
            "CVE-2021-40828"
          ],
          "not_impacted": "All versions starting from 1.5.1",
          "package_slug": "npm/aws-iot-device-sdk-v2",
          "pubdate": "2021-11-23",
          "solution": "Upgrade to version 1.5.1 or above.",
          "title": "Improper Certificate Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-40828",
            "https://github.com/aws/aws-iot-device-sdk-js-v2",
            "https://github.com/awslabs/aws-c-io/",
            "https://github.com/aws/aws-iot-device-sdk-python-v2",
            "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
            "https://github.com/aws/aws-iot-device-sdk-java-v2"
          ],
          "uuid": "f0f3495e-adee-4a11-a6db-9180920665ea"
        },
        {
          "affected_range": "<1.5.18",
          "affected_versions": "All versions before 1.5.18",
          "cvss_v2": "AV:A/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-295",
            "CWE-937"
          ],
          "date": "2021-12-02",
          "description": "Connections initialized by the AWS IoT Device SDK v2 for Java, Python , C++ and Node.js does not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js on Microsoft Windows.",
          "fixed_versions": [
            "1.5.18"
          ],
          "identifier": "CVE-2021-40828",
          "identifiers": [
            "CVE-2021-40828"
          ],
          "not_impacted": "All versions starting from 1.5.18",
          "package_slug": "pypi/awsiotsdk",
          "pubdate": "2021-11-23",
          "solution": "Upgrade to version 1.5.18 or above.",
          "title": "Improper Certificate Validation",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-40828",
            "https://github.com/aws/aws-iot-device-sdk-js-v2",
            "https://github.com/awslabs/aws-c-io/",
            "https://github.com/aws/aws-iot-device-sdk-python-v2",
            "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
            "https://github.com/aws/aws-iot-device-sdk-java-v2"
          ],
          "uuid": "8f1ec41a-4735-46f1-aeac-81b041770d1b"
        }
      ]
    },
    "nvd.nist.gov": {
      "configurations": {
        "CVE_data_version": "4.0",
        "nodes": [
          {
            "children": [
              {
                "children": [],
                "cpe_match": [
                  {
                    "cpe23Uri": "cpe:2.3:a:amazon:amazon_web_services_aws-c-io:*:*:*:*:*:*:*:*",
                    "cpe_name": [],
                    "versionEndExcluding": "0.9.13",
                    "vulnerable": true
                  },
                  {
                    "cpe23Uri": "cpe:2.3:a:amazon:amazon_web_services_internet_of_things_device_software_development_kit_v2:*:*:*:*:*:java:*:*",
                    "cpe_name": [],
                    "versionEndExcluding": "1.3.3",
                    "vulnerable": true
                  },
                  {
                    "cpe23Uri": "cpe:2.3:a:amazon:amazon_web_services_internet_of_things_device_software_development_kit_v2:*:*:*:*:*:node.js:*:*",
                    "cpe_name": [],
                    "versionEndExcluding": "1.5.1",
                    "vulnerable": true
                  },
                  {
                    "cpe23Uri": "cpe:2.3:a:amazon:amazon_web_services_internet_of_things_device_software_development_kit_v2:*:*:*:*:*:python:*:*",
                    "cpe_name": [],
                    "versionEndExcluding": "1.5.18",
                    "vulnerable": true
                  },
                  {
                    "cpe23Uri": "cpe:2.3:a:amazon:amazon_web_services_internet_of_things_device_software_development_kit_v2:*:*:*:*:*:c\\+\\+:*:*",
                    "cpe_name": [],
                    "versionEndExcluding": "1.12.7",
                    "vulnerable": true
                  }
                ],
                "operator": "OR"
              },
              {
                "children": [],
                "cpe_match": [
                  {
                    "cpe23Uri": "cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*",
                    "cpe_name": [],
                    "vulnerable": false
                  }
                ],
                "operator": "OR"
              }
            ],
            "cpe_match": [],
            "operator": "AND"
          }
        ]
      },
      "cve": {
        "CVE_data_meta": {
          "ASSIGNER": "cve-notifications-us@f-secure.com",
          "ID": "CVE-2021-40828"
        },
        "data_format": "MITRE",
        "data_type": "CVE",
        "data_version": "4.0",
        "description": {
          "description_data": [
            {
              "lang": "en",
              "value": "Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3), Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows."
            }
          ]
        },
        "problemtype": {
          "problemtype_data": [
            {
              "description": [
                {
                  "lang": "en",
                  "value": "CWE-295"
                }
              ]
            }
          ]
        },
        "references": {
          "reference_data": [
            {
              "name": "https://github.com/aws/aws-iot-device-sdk-js-v2",
              "refsource": "MISC",
              "tags": [
                "Product"
              ],
              "url": "https://github.com/aws/aws-iot-device-sdk-js-v2"
            },
            {
              "name": "https://github.com/awslabs/aws-c-io/",
              "refsource": "MISC",
              "tags": [
                "Product"
              ],
              "url": "https://github.com/awslabs/aws-c-io/"
            },
            {
              "name": "https://github.com/aws/aws-iot-device-sdk-python-v2",
              "refsource": "MISC",
              "tags": [
                "Product"
              ],
              "url": "https://github.com/aws/aws-iot-device-sdk-python-v2"
            },
            {
              "name": "https://github.com/aws/aws-iot-device-sdk-cpp-v2",
              "refsource": "MISC",
              "tags": [
                "Product"
              ],
              "url": "https://github.com/aws/aws-iot-device-sdk-cpp-v2"
            },
            {
              "name": "https://github.com/aws/aws-iot-device-sdk-java-v2",
              "refsource": "MISC",
              "tags": [
                "Product"
              ],
              "url": "https://github.com/aws/aws-iot-device-sdk-java-v2"
            }
          ]
        }
      },
      "impact": {
        "baseMetricV2": {
          "acInsufInfo": false,
          "cvssV2": {
            "accessComplexity": "LOW",
            "accessVector": "ADJACENT_NETWORK",
            "authentication": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 5.8,
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "vectorString": "AV:A/AC:L/Au:N/C:P/I:P/A:P",
            "version": "2.0"
          },
          "exploitabilityScore": 6.5,
          "impactScore": 6.4,
          "obtainAllPrivilege": false,
          "obtainOtherPrivilege": false,
          "obtainUserPrivilege": false,
          "severity": "MEDIUM",
          "userInteractionRequired": false
        },
        "baseMetricV3": {
          "cvssV3": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        }
      },
      "lastModifiedDate": "2021-12-02T14:32Z",
      "publishedDate": "2021-11-23T00:15Z"
    }
  }
}