{
    "GSD": {
        "alias": "CVE-2021-22137",
        "description": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices.",
        "id": "GSD-2021-22137",
        "references": [
            "https://www.suse.com/security/cve/CVE-2021-22137.html",
            "https://access.redhat.com/errata/RHSA-2022:5606",
            "https://access.redhat.com/errata/RHSA-2022:6407"
        ]
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "security@elastic.co",
                "ID": "CVE-2021-22137",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Elasticsearch",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "before 7.11.2 and 6.8.15"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "Elastic"
                        }
                    ]
                }
            },
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices."
                    }
                ]
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125",
                        "refsource": "MISC",
                        "url": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
                    },
                    {
                        "name": "https://security.netapp.com/advisory/ntap-20210625-0003/",
                        "refsource": "CONFIRM",
                        "url": "https://security.netapp.com/advisory/ntap-20210625-0003/"
                    }
                ]
            }
        },
        "gitlab.com": {
            "advisories": [
                {
                    "affected_range": "(,6.8.14],[7.11.0,7.11.1]",
                    "affected_versions": "All versions up to 6.8.14, all versions starting from 7.11.0 up to 7.11.1",
                    "cvss_v2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-200",
                        "CWE-937"
                    ],
                    "date": "2022-06-22",
                    "description": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices.",
                    "fixed_versions": [
                        "6.8.15",
                        "7.11.2"
                    ],
                    "identifier": "CVE-2021-22137",
                    "identifiers": [
                        "GHSA-hr65-qq6p-87r4",
                        "CVE-2021-22137"
                    ],
                    "not_impacted": "All versions after 6.8.14 before 7.11.0, all versions after 7.11.1",
                    "package_slug": "maven/org.elasticsearch.client/elasticsearch-rest-client",
                    "pubdate": "2022-05-24",
                    "solution": "Upgrade to versions 6.8.15, 7.11.2 or above.",
                    "title": "Exposure of Sensitive Information to an Unauthorized Actor",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2021-22137",
                        "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125",
                        "https://security.netapp.com/advisory/ntap-20210625-0003/",
                        "https://github.com/advisories/GHSA-hr65-qq6p-87r4"
                    ],
                    "uuid": "42df4ae8-26ae-4c0b-9048-14c73bf2e4f9"
                },
                {
                    "affected_range": "(,6.8.14],[7.11.0,7.11.1]",
                    "affected_versions": "All versions up to 6.8.14, all versions starting from 7.11.0 up to 7.11.1",
                    "cvss_v2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-281",
                        "CWE-937"
                    ],
                    "date": "2023-08-13",
                    "description": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices.",
                    "fixed_versions": [
                        "6.8.15",
                        "7.11.2"
                    ],
                    "identifier": "CVE-2021-22137",
                    "identifiers": [
                        "GHSA-hr65-qq6p-87r4",
                        "CVE-2021-22137"
                    ],
                    "not_impacted": "All versions after 6.8.14 before 7.11.0, all versions after 7.11.1",
                    "package_slug": "maven/org.elasticsearch/elasticsearch",
                    "pubdate": "2022-05-24",
                    "solution": "Upgrade to versions 6.8.15, 7.11.2 or above.",
                    "title": "Improper Preservation of Permissions",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2021-22137",
                        "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125",
                        "https://security.netapp.com/advisory/ntap-20210625-0003/",
                        "https://github.com/advisories/GHSA-hr65-qq6p-87r4"
                    ],
                    "uuid": "b74e6043-55d0-4d9c-810a-b8a71dd854a6"
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndExcluding": "6.8.15",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndExcluding": "7.11.2",
                                "versionStartIncluding": "7.11.0",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "security@elastic.co",
                    "ID": "CVE-2021-22137"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-281"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125",
                            "refsource": "MISC",
                            "tags": [
                                "Vendor Advisory"
                            ],
                            "url": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
                        },
                        {
                            "name": "https://security.netapp.com/advisory/ntap-20210625-0003/",
                            "refsource": "CONFIRM",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://security.netapp.com/advisory/ntap-20210625-0003/"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV2": {
                    "acInsufInfo": false,
                    "cvssV2": {
                        "accessComplexity": "MEDIUM",
                        "accessVector": "NETWORK",
                        "authentication": "NONE",
                        "availabilityImpact": "NONE",
                        "baseScore": 4.3,
                        "confidentialityImpact": "PARTIAL",
                        "integrityImpact": "NONE",
                        "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
                        "version": "2.0"
                    },
                    "exploitabilityScore": 8.6,
                    "impactScore": 2.9,
                    "obtainAllPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "obtainUserPrivilege": false,
                    "severity": "MEDIUM",
                    "userInteractionRequired": false
                },
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 5.3,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 1.4
                }
            },
            "lastModifiedDate": "2022-11-04T18:30Z",
            "publishedDate": "2021-05-13T18:15Z"
        }
    }
}