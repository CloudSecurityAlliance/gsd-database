{
  "GSD": {
    "alias": "CVE-2021-36372",
    "description": "In Apache Ozone versions prior to 1.2.0, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked.",
    "id": "GSD-2021-36372"
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2021-36372"
      ],
      "details": "In Apache Ozone versions prior to 1.2.0, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked.",
      "id": "GSD-2021-36372",
      "modified": "2023-12-13T01:23:17.211638Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "security@apache.org",
        "ID": "CVE-2021-36372",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "Apache Ozone",
                    "version": {
                      "version_data": [
                        {
                          "version_affected": "<=",
                          "version_name": "1.1",
                          "version_value": "1.1"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "Apache Software Foundation"
            }
          ]
        }
      },
      "credits": [
        {
          "lang": "en",
          "value": "Apache Ozone would like to thank Marton Elek for reporting this issue."
        }
      ],
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "In Apache Ozone versions prior to 1.2.0, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked."
          }
        ]
      },
      "generator": {
        "engine": "Vulnogram 0.0.9"
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "cweId": "CWE-273",
                "lang": "eng",
                "value": "CWE-273 Improper Check for Dropped Privileges"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://mail-archives.apache.org/mod_mbox/ozone-dev/202111.mbox/%3C5029c1ac-4685-8492-e3cb-ab48c5c370cf%40apache.org%3E",
            "refsource": "MISC",
            "url": "https://mail-archives.apache.org/mod_mbox/ozone-dev/202111.mbox/%3C5029c1ac-4685-8492-e3cb-ab48c5c370cf%40apache.org%3E"
          },
          {
            "name": "http://www.openwall.com/lists/oss-security/2021/11/19/1",
            "refsource": "MISC",
            "url": "http://www.openwall.com/lists/oss-security/2021/11/19/1"
          }
        ]
      },
      "source": {
        "defect": [
          "HDDS-5315"
        ],
        "discovery": "UNKNOWN"
      },
      "work_around": [
        {
          "lang": "en",
          "value": "Upgrade to Apache Ozone release version 1.2.0"
        }
      ]
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": "(,1.2.0)",
          "affected_versions": "All versions before 1.2.0",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-273",
            "CWE-937"
          ],
          "date": "2021-11-23",
          "description": "In Apache Ozone versions prior to 1.2.0, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked.",
          "fixed_versions": [
            "1.2.0"
          ],
          "identifier": "CVE-2021-36372",
          "identifiers": [
            "GHSA-86fh-j58m-7pf5",
            "CVE-2021-36372"
          ],
          "not_impacted": "All versions starting from 1.2.0",
          "package_slug": "maven/org.apache.ozone/ozone-main",
          "pubdate": "2021-11-23",
          "solution": "Upgrade to version 1.2.0 or above.",
          "title": "Improper Check for Dropped Privileges",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-36372",
            "https://github.com/advisories/GHSA-86fh-j58m-7pf5"
          ],
          "uuid": "f6485944-8271-494f-ac87-fe13332d962e"
        },
        {
          "affected_range": "(,1.2.0)",
          "affected_versions": "All versions before 1.2.0",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-273",
            "CWE-937"
          ],
          "date": "2021-11-20",
          "description": "In Apache Ozone, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked.",
          "fixed_versions": [
            "1.2.0"
          ],
          "identifier": "CVE-2021-36372",
          "identifiers": [
            "CVE-2021-36372"
          ],
          "not_impacted": "All versions starting from 1.2.0",
          "package_slug": "maven/org.apache.ozone/ozone",
          "pubdate": "2021-11-19",
          "solution": "Upgrade to version 1.2.0 or above.",
          "title": "Improper Check for Dropped Privileges",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-36372",
            "https://mail-archives.apache.org/mod_mbox/ozone-dev/202111.mbox/%3C5029c1ac-4685-8492-e3cb-ab48c5c370cf%40apache.org%3E",
            "http://www.openwall.com/lists/oss-security/2021/11/19/1"
          ],
          "uuid": "fb33a6a0-d521-4f02-b84a-9a43e95c46cf"
        }
      ]
    },
    "nvd.nist.gov": {
      "cve": {
        "configurations": [
          {
            "nodes": [
              {
                "cpeMatch": [
                  {
                    "criteria": "cpe:2.3:a:apache:ozone:*:*:*:*:*:*:*:*",
                    "matchCriteriaId": "9DCCB9A0-2922-4ED3-BF73-E84FDDAE7205",
                    "versionEndExcluding": "1.2.0",
                    "vulnerable": true
                  }
                ],
                "negate": false,
                "operator": "OR"
              }
            ]
          }
        ],
        "descriptions": [
          {
            "lang": "en",
            "value": "In Apache Ozone versions prior to 1.2.0, Initially generated block tokens are persisted to the metadata database and can be retrieved with authenticated users with permission to the key. Authenticated users may use them even after access is revoked."
          },
          {
            "lang": "es",
            "value": "En Apache Ozone versiones anteriores a 1.2.0, los tokens de bloque generados inicialmente son persistidos en la base de datos de metadatos y pueden ser recuperados con usuarios autenticados con permiso a la clave. Los usuarios autenticados pueden usarlos incluso despu\u00e9s de que es revocado el acceso"
          }
        ],
        "id": "CVE-2021-36372",
        "lastModified": "2024-01-31T10:15:08.297",
        "metrics": {
          "cvssMetricV2": [
            {
              "acInsufInfo": false,
              "baseSeverity": "HIGH",
              "cvssData": {
                "accessComplexity": "LOW",
                "accessVector": "NETWORK",
                "authentication": "NONE",
                "availabilityImpact": "PARTIAL",
                "baseScore": 7.5,
                "confidentialityImpact": "PARTIAL",
                "integrityImpact": "PARTIAL",
                "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                "version": "2.0"
              },
              "exploitabilityScore": 10.0,
              "impactScore": 6.4,
              "obtainAllPrivilege": false,
              "obtainOtherPrivilege": false,
              "obtainUserPrivilege": false,
              "source": "nvd@nist.gov",
              "type": "Primary",
              "userInteractionRequired": false
            }
          ],
          "cvssMetricV31": [
            {
              "cvssData": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 9.8,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                "version": "3.1"
              },
              "exploitabilityScore": 3.9,
              "impactScore": 5.9,
              "source": "nvd@nist.gov",
              "type": "Primary"
            }
          ]
        },
        "published": "2021-11-19T10:15:07.983",
        "references": [
          {
            "source": "security@apache.org",
            "tags": [
              "Third Party Advisory"
            ],
            "url": "http://www.openwall.com/lists/oss-security/2021/11/19/1"
          },
          {
            "source": "security@apache.org",
            "tags": [
              "Mailing List",
              "Mitigation",
              "Vendor Advisory"
            ],
            "url": "https://mail-archives.apache.org/mod_mbox/ozone-dev/202111.mbox/%3C5029c1ac-4685-8492-e3cb-ab48c5c370cf%40apache.org%3E"
          }
        ],
        "sourceIdentifier": "security@apache.org",
        "vulnStatus": "Modified",
        "weaknesses": [
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-273"
              }
            ],
            "source": "security@apache.org",
            "type": "Primary"
          },
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-273"
              }
            ],
            "source": "nvd@nist.gov",
            "type": "Secondary"
          }
        ]
      }
    }
  }
}