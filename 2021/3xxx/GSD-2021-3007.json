{
  "GSD": {
    "alias": "CVE-2021-3007",
    "description": "** DISPUTED ** Laminas Project laminas-http before 2.14.2, and Zend Framework 3.0.0, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the __destruct method of the Zend\\Http\\Response\\Stream class in Stream.php. NOTE: Zend Framework is no longer supported by the maintainer. NOTE: the laminas-http vendor considers this a \"vulnerability in the PHP language itself\" but has added certain type checking as a way to prevent exploitation in (unrecommended) use cases where attacker-supplied data can be deserialized.",
    "id": "GSD-2021-3007"
  },
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2021-3007"
      ],
      "details": "** DISPUTED ** Laminas Project laminas-http before 2.14.2, and Zend Framework 3.0.0, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the __destruct method of the Zend\\Http\\Response\\Stream class in Stream.php. NOTE: Zend Framework is no longer supported by the maintainer. NOTE: the laminas-http vendor considers this a \"vulnerability in the PHP language itself\" but has added certain type checking as a way to prevent exploitation in (unrecommended) use cases where attacker-supplied data can be deserialized.",
      "id": "GSD-2021-3007",
      "modified": "2023-12-13T01:23:34.157301Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "cve@mitre.org",
        "ID": "CVE-2021-3007",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "n/a",
                    "version": {
                      "version_data": [
                        {
                          "version_value": "n/a"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "n/a"
            }
          ]
        }
      },
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "** DISPUTED ** Laminas Project laminas-http before 2.14.2, and Zend Framework 3.0.0, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the __destruct method of the Zend\\Http\\Response\\Stream class in Stream.php. NOTE: Zend Framework is no longer supported by the maintainer. NOTE: the laminas-http vendor considers this a \"vulnerability in the PHP language itself\" but has added certain type checking as a way to prevent exploitation in (unrecommended) use cases where attacker-supplied data can be deserialized."
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "lang": "eng",
                "value": "n/a"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md",
            "refsource": "MISC",
            "url": "https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md"
          },
          {
            "name": "https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php",
            "refsource": "MISC",
            "url": "https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php"
          },
          {
            "name": "https://github.com/laminas/laminas-http/pull/48",
            "refsource": "MISC",
            "url": "https://github.com/laminas/laminas-http/pull/48"
          },
          {
            "name": "https://github.com/laminas/laminas-http/releases/tag/2.14.2",
            "refsource": "MISC",
            "url": "https://github.com/laminas/laminas-http/releases/tag/2.14.2"
          },
          {
            "name": "https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/",
            "refsource": "MISC",
            "url": "https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/"
          }
        ]
      }
    },
    "gitlab.com": {
      "advisories": [
        {
          "affected_range": "<2.14.2",
          "affected_versions": "All versions before 2.14.2",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-502",
            "CWE-937"
          ],
          "date": "2021-01-19",
          "description": "Laminas Project laminas-http has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the `__destruct` method of the `Zend\\Http\\Response\\Stream` class in `Stream.php`.",
          "fixed_versions": [
            "2.14.2"
          ],
          "identifier": "CVE-2021-3007",
          "identifiers": [
            "CVE-2021-3007"
          ],
          "not_impacted": "All versions starting from 2.14.2",
          "package_slug": "packagist/laminas/laminas-http",
          "pubdate": "2021-01-04",
          "solution": "Upgrade to version 2.14.2 or above.",
          "title": "Deserialization of Untrusted Data",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-3007"
          ],
          "uuid": "6c34075a-70fb-469e-bd61-52ae5744dc08"
        },
        {
          "affected_range": "=3.0.0",
          "affected_versions": "Version 3.0.0",
          "cvss_v2": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cwe_ids": [
            "CWE-1035",
            "CWE-502",
            "CWE-937"
          ],
          "date": "2021-01-19",
          "description": "Zend Framework, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the `__destruct` method of the Zend\\Http\\Response\\Stream class in `Stream.php.`",
          "fixed_versions": [],
          "identifier": "CVE-2021-3007",
          "identifiers": [
            "CVE-2021-3007"
          ],
          "not_impacted": "",
          "package_slug": "packagist/zendframework/zendframework",
          "pubdate": "2021-01-04",
          "solution": "Unfortunately, there is no solution available yet.",
          "title": "Deserialization of Untrusted Data",
          "urls": [
            "https://nvd.nist.gov/vuln/detail/CVE-2021-3007"
          ],
          "uuid": "ac53b7e1-b75d-4995-b24c-259717d755aa"
        }
      ]
    },
    "nvd.nist.gov": {
      "cve": {
        "configurations": [
          {
            "nodes": [
              {
                "cpeMatch": [
                  {
                    "criteria": "cpe:2.3:a:getlaminas:laminas-http:*:*:*:*:*:*:*:*",
                    "matchCriteriaId": "D2E99556-4806-4485-B0BF-8C0069221705",
                    "versionEndExcluding": "2.14.2",
                    "vulnerable": true
                  },
                  {
                    "criteria": "cpe:2.3:a:zend:zend_framework:3.0.0:*:*:*:*:*:*:*",
                    "matchCriteriaId": "E62B6FB7-619D-4CA0-BC7A-081DC506D311",
                    "vulnerable": true
                  }
                ],
                "negate": false,
                "operator": "OR"
              }
            ]
          }
        ],
        "descriptions": [
          {
            "lang": "en",
            "value": "Laminas Project laminas-http before 2.14.2, and Zend Framework 3.0.0, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the __destruct method of the Zend\\Http\\Response\\Stream class in Stream.php. NOTE: Zend Framework is no longer supported by the maintainer. NOTE: the laminas-http vendor considers this a \"vulnerability in the PHP language itself\" but has added certain type checking as a way to prevent exploitation in (unrecommended) use cases where attacker-supplied data can be deserialized"
          },
          {
            "lang": "es",
            "value": "** EN DISPUTA ** Laminas Project laminas-http versi\u00f3n anterior a 2.14.2, y Zend Framework versi\u00f3n 3.0.0, tiene una vulnerabilidad de deserializaci\u00f3n que puede llevar a la ejecuci\u00f3n remota de c\u00f3digo si el contenido es controlable, relacionado con el m\u00e9todo __destructura de la clase Zend\\Http\\Response\\Stream en Stream.php. NOTA: Zend Framework ya no est\u00e1 soportado por el mantenedor. NOTA: el proveedor de laminas-http considera esto como una \"vulnerabilidad en el propio lenguaje PHP\" pero ha a\u00f1adido cierto tipo de chequeo como una forma de prevenir la explotaci\u00f3n en casos de uso (no recomendado) donde los datos suministrados por el atacante pueden ser deserializados"
          }
        ],
        "id": "CVE-2021-3007",
        "lastModified": "2024-04-11T01:12:40.023",
        "metrics": {
          "cvssMetricV2": [
            {
              "acInsufInfo": false,
              "baseSeverity": "HIGH",
              "cvssData": {
                "accessComplexity": "LOW",
                "accessVector": "NETWORK",
                "authentication": "NONE",
                "availabilityImpact": "PARTIAL",
                "baseScore": 7.5,
                "confidentialityImpact": "PARTIAL",
                "integrityImpact": "PARTIAL",
                "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                "version": "2.0"
              },
              "exploitabilityScore": 10.0,
              "impactScore": 6.4,
              "obtainAllPrivilege": false,
              "obtainOtherPrivilege": false,
              "obtainUserPrivilege": false,
              "source": "nvd@nist.gov",
              "type": "Primary",
              "userInteractionRequired": false
            }
          ],
          "cvssMetricV31": [
            {
              "cvssData": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 9.8,
                "baseSeverity": "CRITICAL",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                "version": "3.1"
              },
              "exploitabilityScore": 3.9,
              "impactScore": 5.9,
              "source": "nvd@nist.gov",
              "type": "Primary"
            }
          ]
        },
        "published": "2021-01-04T03:15:13.527",
        "references": [
          {
            "source": "cve@mitre.org",
            "tags": [
              "Exploit",
              "Third Party Advisory"
            ],
            "url": "https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md"
          },
          {
            "source": "cve@mitre.org",
            "tags": [
              "Patch",
              "Third Party Advisory"
            ],
            "url": "https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php"
          },
          {
            "source": "cve@mitre.org",
            "tags": [
              "Patch",
              "Third Party Advisory"
            ],
            "url": "https://github.com/laminas/laminas-http/pull/48"
          },
          {
            "source": "cve@mitre.org",
            "tags": [
              "Third Party Advisory"
            ],
            "url": "https://github.com/laminas/laminas-http/releases/tag/2.14.2"
          },
          {
            "source": "cve@mitre.org",
            "tags": [
              "Exploit",
              "Third Party Advisory"
            ],
            "url": "https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/"
          }
        ],
        "sourceIdentifier": "cve@mitre.org",
        "vulnStatus": "Modified",
        "weaknesses": [
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-502"
              }
            ],
            "source": "nvd@nist.gov",
            "type": "Primary"
          }
        ]
      }
    }
  }
}