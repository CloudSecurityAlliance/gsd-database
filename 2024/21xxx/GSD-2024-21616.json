{
  "gsd": {
    "metadata": {
      "exploitCode": "unknown",
      "remediation": "unknown",
      "reportConfidence": "confirmed",
      "type": "vulnerability"
    },
    "osvSchema": {
      "aliases": [
        "CVE-2024-21616"
      ],
      "details": "\nAn Improper Validation of Syntactic Correctness of Input vulnerability in Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an unauthenticated, network-based attacker to cause Denial of Service (DoS).\n\nOn all Junos OS MX Series and SRX Series platforms, when SIP ALG is enabled, and a specific SIP packet is received and processed, NAT IP allocation fails for genuine traffic, which causes Denial of Service (DoS). Continuous receipt of this specific SIP ALG packet will cause a sustained DoS condition.\n\nNAT IP usage can be monitored by running the following command.\n\nuser@srx> show security nat resource-usage source-pool <source_pool_name>\n\n\nPool name: source_pool_name\n..\nAddress Factor-index Port-range Used Avail Total Usage\nX.X.X.X\n0 Single Ports 50258 52342 62464 96% <<<<<\n- Alg Ports 0 2048 2048 0%\nThis issue affects:\n\nJuniper Networks Junos OS on MX Series and SRX Series\n\n\n\n  *  All versions earlier than 21.2R3-S6;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\n\n\n",
      "id": "GSD-2024-21616",
      "modified": "2023-12-28T06:02:03.488446Z",
      "schema_version": "1.4.0"
    }
  },
  "namespaces": {
    "cve.org": {
      "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "ID": "CVE-2024-21616",
        "STATE": "PUBLIC"
      },
      "affects": {
        "vendor": {
          "vendor_data": [
            {
              "product": {
                "product_data": [
                  {
                    "product_name": "Junos OS",
                    "version": {
                      "version_data": [
                        {
                          "version_affected": "<",
                          "version_name": "0",
                          "version_value": "21.2R3-S6"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "21.3",
                          "version_value": "21.3R3-S5"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "21.4",
                          "version_value": "21.4R3-S5"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "22.1",
                          "version_value": "22.1R3-S4"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "22.2",
                          "version_value": "22.2R3-S3"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "22.3",
                          "version_value": "22.3R3-S1"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "22.4",
                          "version_value": "22.4R2-S2, 22.4R3"
                        },
                        {
                          "version_affected": "<",
                          "version_name": "23.2",
                          "version_value": "23.2R1-S1, 23.2R2"
                        }
                      ]
                    }
                  }
                ]
              },
              "vendor_name": "Juniper Networks"
            }
          ]
        }
      },
      "configuration": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<p>To be affected the SIP ALG needs to be enabled, either implicitly / by default or by way of configuration.</p><p>Please verify on SRX with:</p><code>  user@host&gt; show security alg status | match sip</code><br/><code>  SIP : Enabled</code><br/><p>Please verify on MX whether the following is configured:</p><code>  user@host&gt; show security alg status | match sip</code><br/><code>  SIP : Enabled</code><br/><code>  [services ... rule &lt;rule-name&gt; (term &lt;term-name&gt; ) from/match application/application-set &lt;name&gt;]</code><br/><p>where either</p><code>  a. name = junos-sip</code><br/><p>or an application or application-set refers to SIP:</p><code>  b. [applications application &lt;name&gt; application-protocol sip]</code><br/><p>or</p><code>  c. [applications application-set &lt;name&gt; application junos-sip]</code><br/>"
            }
          ],
          "value": "To be affected the SIP ALG needs to be enabled, either implicitly / by default or by way of configuration.\n\nPlease verify on SRX with:\n\n  user@host> show security alg status | match sip\n  SIP : Enabled\nPlease verify on MX whether the following is configured:\n\n  user@host> show security alg status | match sip\n  SIP : Enabled\n  [services ... rule <rule-name> (term <term-name> ) from/match application/application-set <name>]\nwhere either\n\n  a. name = junos-sip\nor an application or application-set refers to SIP:\n\n  b. [applications application <name> application-protocol sip]\nor\n\n  c. [applications application-set <name> application junos-sip]\n"
        }
      ],
      "data_format": "MITRE",
      "data_type": "CVE",
      "data_version": "4.0",
      "description": {
        "description_data": [
          {
            "lang": "eng",
            "value": "\nAn Improper Validation of Syntactic Correctness of Input vulnerability in Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an unauthenticated, network-based attacker to cause Denial of Service (DoS).\n\nOn all Junos OS MX Series and SRX Series platforms, when SIP ALG is enabled, and a specific SIP packet is received and processed, NAT IP allocation fails for genuine traffic, which causes Denial of Service (DoS). Continuous receipt of this specific SIP ALG packet will cause a sustained DoS condition.\n\nNAT IP usage can be monitored by running the following command.\n\nuser@srx> show security nat resource-usage source-pool <source_pool_name>\n\n\nPool name: source_pool_name\n..\nAddress Factor-index Port-range Used Avail Total Usage\nX.X.X.X\n0 Single Ports 50258 52342 62464 96% <<<<<\n- Alg Ports 0 2048 2048 0%\nThis issue affects:\n\nJuniper Networks Junos OS on MX Series and SRX Series\n\n\n\n  *  All versions earlier than 21.2R3-S6;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\n\n\n"
          }
        ]
      },
      "exploit": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<p>Juniper SIRT is not aware of any malicious exploitation of this vulnerability.</p>"
            }
          ],
          "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability.\n\n"
        }
      ],
      "generator": {
        "engine": "Vulnogram 0.1.0-av217"
      },
      "impact": {
        "cvss": [
          {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
          }
        ]
      },
      "problemtype": {
        "problemtype_data": [
          {
            "description": [
              {
                "cweId": "CWE-1286",
                "lang": "eng",
                "value": "CWE-1286: Improper Validation of Syntactic Correctness of Input"
              }
            ]
          },
          {
            "description": [
              {
                "lang": "eng",
                "value": "Denial of Service (DoS)"
              }
            ]
          }
        ]
      },
      "references": {
        "reference_data": [
          {
            "name": "https://supportportal.juniper.net/JSA75757",
            "refsource": "MISC",
            "url": "https://supportportal.juniper.net/JSA75757"
          },
          {
            "name": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N",
            "refsource": "MISC",
            "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N"
          }
        ]
      },
      "solution": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<p>The following software releases have been updated to resolve this specific issue: Junos OS 21.2R3-S6, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.2R1-S1, 23.2R2, 23.4R1, and all subsequent releases.</p>"
            }
          ],
          "value": "The following software releases have been updated to resolve this specific issue: Junos OS 21.2R3-S6, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.2R1-S1, 23.2R2, 23.4R1, and all subsequent releases.\n\n"
        }
      ],
      "source": {
        "advisory": "JSA75757",
        "defect": [
          "1702811"
        ],
        "discovery": "USER"
      },
      "work_around": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<p>There are no known workarounds for this issue, but it should be considered to disable the SIP ALG if it's not strictly needed.</p>"
            }
          ],
          "value": "There are no known workarounds for this issue, but it should be considered to disable the SIP ALG if it's not strictly needed.\n\n"
        }
      ]
    },
    "nvd.nist.gov": {
      "cve": {
        "descriptions": [
          {
            "lang": "en",
            "value": "\nAn Improper Validation of Syntactic Correctness of Input vulnerability in Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an unauthenticated, network-based attacker to cause Denial of Service (DoS).\n\nOn all Junos OS MX Series and SRX Series platforms, when SIP ALG is enabled, and a specific SIP packet is received and processed, NAT IP allocation fails for genuine traffic, which causes Denial of Service (DoS). Continuous receipt of this specific SIP ALG packet will cause a sustained DoS condition.\n\nNAT IP usage can be monitored by running the following command.\n\nuser@srx> show security nat resource-usage source-pool <source_pool_name>\n\n\nPool name: source_pool_name\n..\nAddress Factor-index Port-range Used Avail Total Usage\nX.X.X.X\n0 Single Ports 50258 52342 62464 96% <<<<<\n- Alg Ports 0 2048 2048 0%\nThis issue affects:\n\nJuniper Networks Junos OS on MX Series and SRX Series\n\n\n\n  *  All versions earlier than 21.2R3-S6;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\n\n\n"
          },
          {
            "lang": "es",
            "value": "Una vulnerabilidad de validaci\u00f3n inadecuada de la correcci\u00f3n sint\u00e1ctica de la entrada en Packet Forwarding Engine (PFE) de Juniper Networks Junos OS permite que un atacante no autenticado basado en la red provoque una denegaci\u00f3n de servicio (DoS). En todas las plataformas Junos OS MX Series y SRX Series, cuando SIP ALG est\u00e1 habilitado y se recibe y procesa un paquete SIP espec\u00edfico, la asignaci\u00f3n de IP NAT falla para el tr\u00e1fico genuino, lo que provoca una denegaci\u00f3n de servicio (DoS). La recepci\u00f3n continua de este paquete SIP ALG espec\u00edfico provocar\u00e1 una condici\u00f3n DoS sostenida. El uso de NAT IP se puede monitorear ejecutando el siguiente comando. user@srx&gt; show security nat resource-usage source-pool  Pool name: source_pool_name. Direcci\u00f3n Factor-\u00edndice Rango de puertos Disponibilidad utilizada Uso total XXXX 0 Puertos individuales 50258 52342 62464 96% &lt;&lt;&lt;&lt;&lt; - Puertos Alg 0 2048 2048 0% Este problema afecta a: Juniper Networks Junos OS en las series MX y SRX * Todas las versiones anteriores a 21.2R3-S6; * Versiones 21.3 anteriores a 21.3R3-S5; * Versiones 21.4 anteriores a 21.4R3-S5; * Versiones 22.1 anteriores a 22.1R3-S4; * Versiones 22.2 anteriores a 22.2R3-S3; * Versiones 22.3 anteriores a 22.3R3-S1; * Versiones 22.4 anteriores a 22.4R2-S2, 22.4R3; * Versiones 23.2 anteriores a 23.2R1-S1, 23.2R2."
          }
        ],
        "id": "CVE-2024-21616",
        "lastModified": "2024-01-12T13:47:31.250",
        "metrics": {
          "cvssMetricV31": [
            {
              "cvssData": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 7.5,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "version": "3.1"
              },
              "exploitabilityScore": 3.9,
              "impactScore": 3.6,
              "source": "sirt@juniper.net",
              "type": "Secondary"
            }
          ]
        },
        "published": "2024-01-12T01:15:50.027",
        "references": [
          {
            "source": "sirt@juniper.net",
            "url": "https://supportportal.juniper.net/JSA75757"
          },
          {
            "source": "sirt@juniper.net",
            "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N"
          }
        ],
        "sourceIdentifier": "sirt@juniper.net",
        "vulnStatus": "Awaiting Analysis",
        "weaknesses": [
          {
            "description": [
              {
                "lang": "en",
                "value": "CWE-1286"
              }
            ],
            "source": "sirt@juniper.net",
            "type": "Secondary"
          }
        ]
      }
    }
  }
}