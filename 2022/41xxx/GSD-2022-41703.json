{
    "GSD": {
        "alias": "CVE-2022-41703",
        "id": "GSD-2022-41703"
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "security@apache.org",
                "ID": "CVE-2022-41703",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "Apache Superset",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_affected": "<",
                                                    "version_name": "2.0.0",
                                                    "version_value": "2.0.1"
                                                },
                                                {
                                                    "version_affected": "<=",
                                                    "version_name": "0",
                                                    "version_value": "1.5.2"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "Apache Software Foundation"
                        }
                    ]
                }
            },
            "credits": [
                {
                    "lang": "en",
                    "value": "Mingyu Son"
                }
            ],
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "A vulnerability in the SQL Alchemy connector of Apache Superset allows an authenticated user with read access to a specific database to add subqueries to the WHERE and HAVING fields referencing tables on the same database that the user should not have access to, despite the user having the feature flag \"ALLOW_ADHOC_SUBQUERY\" disabled (default value).  This issue affects Apache Superset version 1.5.2 and prior versions and version 2.0.0.\n\n\n"
                    }
                ]
            },
            "generator": {
                "engine": "Vulnogram 0.1.0-dev"
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "SQL injection in certain query object fields"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos",
                        "refsource": "MISC",
                        "url": "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos"
                    }
                ]
            },
            "source": {
                "discovery": "UNKNOWN"
            }
        },
        "gitlab.com": {
            "advisories": [
                {
                    "affected_range": "<=1.5.2||==2.0.0",
                    "affected_versions": "All versions up to 1.5.2, version 2.0.0",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-89",
                        "CWE-937"
                    ],
                    "date": "2023-04-11",
                    "description": "A vulnerability in the SQL Alchemy connector of Apache Superset allows an authenticated user with read access to a specific database to add subqueries to the WHERE and HAVING fields referencing tables on the same database that the user should not have access to, despite the user having the feature flag \"ALLOW_ADHOC_SUBQUERY\" disabled (default value). This issue affects Apache Superset version 1.5.2 and prior versions and version 2.0.0.",
                    "fixed_versions": [
                        "1.5.3",
                        "2.0.1"
                    ],
                    "identifier": "CVE-2022-41703",
                    "identifiers": [
                        "CVE-2022-41703",
                        "GHSA-cxvp-3frm-3876"
                    ],
                    "not_impacted": "All versions after 1.5.2 before 2.0.0, all versions after 2.0.0",
                    "package_slug": "pypi/apache-superset",
                    "pubdate": "2023-01-16",
                    "solution": "Upgrade to versions 1.5.3, 2.0.1 or above.",
                    "title": "Apache Superset's SQL Alchemy connector vulnerable to SQL Injection",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2022-41703",
                        "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos",
                        "https://github.com/advisories/GHSA-cxvp-3frm-3876"
                    ],
                    "uuid": "716fc16d-e4bf-47a8-95ed-c1a82cc1c04b"
                },
                {
                    "affected_range": "<=1.5.2||==2.0.0",
                    "affected_versions": "All versions up to 1.5.2, version 2.0.0",
                    "cvss_v3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
                    "cwe_ids": [
                        "CWE-1035",
                        "CWE-89",
                        "CWE-937"
                    ],
                    "date": "2023-04-11",
                    "description": "A vulnerability in the SQL Alchemy connector of Apache Superset allows an authenticated user with read access to a specific database to add subqueries to the WHERE and HAVING fields referencing tables on the same database that the user should not have access to, despite the user having the feature flag \"ALLOW_ADHOC_SUBQUERY\" disabled (default value). This issue affects Apache Superset version 1.5.2 and prior versions and version 2.0.0.",
                    "fixed_versions": [],
                    "identifier": "CVE-2022-41703",
                    "identifiers": [
                        "CVE-2022-41703"
                    ],
                    "not_impacted": "",
                    "package_slug": "pypi/superset",
                    "pubdate": "2023-01-16",
                    "solution": "Unfortunately, there is no solution available yet.",
                    "title": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
                    "urls": [
                        "https://nvd.nist.gov/vuln/detail/CVE-2022-41703",
                        "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos"
                    ],
                    "uuid": "dfb60863-5fe2-49bc-baa8-dc0fc0f5ca38"
                }
            ]
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:superset:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndIncluding": "1.5.2",
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:superset:2.0.0:rc1:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:superset:2.0.0:rc2:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            },
                            {
                                "cpe23Uri": "cpe:2.3:a:apache:superset:2.0.0:-:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "security@apache.org",
                    "ID": "CVE-2022-41703"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "A vulnerability in the SQL Alchemy connector of Apache Superset allows an authenticated user with read access to a specific database to add subqueries to the WHERE and HAVING fields referencing tables on the same database that the user should not have access to, despite the user having the feature flag \"ALLOW_ADHOC_SUBQUERY\" disabled (default value).  This issue affects Apache Superset version 1.5.2 and prior versions and version 2.0.0.\n\n\n"
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-89"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos",
                            "refsource": "MISC",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "https://lists.apache.org/thread/g7jjw0okxjk5y57pbbxy19ydw42kqcos"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 5.4,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 2.8,
                    "impactScore": 2.5
                }
            },
            "lastModifiedDate": "2023-04-11T15:15Z",
            "publishedDate": "2023-01-16T11:15Z"
        }
    }
}